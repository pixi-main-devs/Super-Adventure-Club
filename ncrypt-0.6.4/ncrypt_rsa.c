/* Generated by Pyrex 0.9.5 on Sat May 21 07:00:51 2011 */

#include "Python.h"
#include "structmember.h"
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
__PYX_EXTERN_C double pow(double, double);
#include "openssl/rsa.h"
#include "openssl/evp.h"
#include "openssl/crypto.h"
#include "openssl/bn.h"
#include "openssl/bio.h"
#include "utils.h"
#include "openssl/pem.h"
#include "stdlib.h"
#include "string.h"


typedef struct {PyObject **p; char *s;} __Pyx_InternTabEntry; /*proto*/
typedef struct {PyObject **p; char *s; long n;} __Pyx_StringTabEntry; /*proto*/

static PyObject *__pyx_m;
static PyObject *__pyx_b;
static int __pyx_lineno;
static char *__pyx_filename;
static char **__pyx_f;

static int __Pyx_GetStarArgs(PyObject **args, PyObject **kwds, char *kwd_list[], int nargs, PyObject **args2, PyObject **kwds2); /*proto*/

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static PyObject *__Pyx_CreateClass(PyObject *bases, PyObject *dict, PyObject *name, char *modname); /*proto*/

static void __Pyx_WriteUnraisable(char *name); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static PyObject *__Pyx_UnpackItem(PyObject *); /*proto*/
static int __Pyx_EndUnpack(PyObject *); /*proto*/

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

static int __Pyx_SetVtable(PyObject *dict, void *vtable); /*proto*/

static void __Pyx_AddTraceback(char *funcname); /*proto*/

/* Declarations from ncrypt_rsa */

struct __pyx_t_10ncrypt_rsa_PemCbData {
  int length;
  char (*data);
};


struct __pyx_obj_10ncrypt_rsa_RSAKey {
  PyObject_HEAD
  struct __pyx_vtabstruct_10ncrypt_rsa_RSAKey *__pyx_vtab;
  RSA (*rsa);
};

struct __pyx_vtabstruct_10ncrypt_rsa_RSAKey {
  void ((*loadCPublicKey)(struct __pyx_obj_10ncrypt_rsa_RSAKey *,RSA (*)));
  void ((*loadCPrivateKey)(struct __pyx_obj_10ncrypt_rsa_RSAKey *,RSA (*)));
};
static struct __pyx_vtabstruct_10ncrypt_rsa_RSAKey *__pyx_vtabptr_10ncrypt_rsa_RSAKey;

static PyTypeObject *__pyx_ptype_10ncrypt_rsa_RSAKey = 0;
static PyObject *__pyx_k3;
static PyObject *__pyx_k4;
static PyObject *__pyx_k5;
static PyObject *__pyx_k6;
static PyObject *__pyx_k7;
static PyObject *__pyx_k8;
static PyObject *__pyx_k9;
static int (__pyx_f_10ncrypt_rsa__password_callback(char (*),int ,int ,void (*))); /*proto*/
static void (__pyx_f_10ncrypt_rsa__rsa_callback(int ,int ,void (*))); /*proto*/


/* Implementation of ncrypt_rsa */


static PyObject *__pyx_n_ncrypt_err;
static PyObject *__pyx_n_RSAError;
static PyObject *__pyx_n_PADDING_PKCS1;
static PyObject *__pyx_n_PADDING_PKCS1_OAEP;
static PyObject *__pyx_n_BaseLibraryError;
static PyObject *__pyx_n_True;

static int __pyx_f_10ncrypt_rsa__password_callback(char (*__pyx_v_buf),int __pyx_v_size,int __pyx_v_rwflag,void (*__pyx_v_u)) {
  struct __pyx_t_10ncrypt_rsa_PemCbData (*__pyx_v_d);
  int __pyx_v_cp_size;
  int __pyx_r;
  int __pyx_1;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":97 */
  __pyx_v_d = ((struct __pyx_t_10ncrypt_rsa_PemCbData (*))__pyx_v_u);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":98 */
  __pyx_1 = (__pyx_v_d->data == 0);
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":99 */
    (__pyx_v_buf[0]) = ((char )0);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":100 */
    __pyx_r = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":102 */
    __pyx_1 = (__pyx_v_size > __pyx_v_d->length);
    if (__pyx_1) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":103 */
      __pyx_v_cp_size = __pyx_v_d->length;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":105 */
      __pyx_v_cp_size = __pyx_v_size;
    }
    __pyx_L3:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":106 */
    memcpy(__pyx_v_buf,__pyx_v_d->data,__pyx_v_cp_size);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":107 */
    (__pyx_v_buf[(__pyx_v_size - 1)]) = ((char )0);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":108 */
    __pyx_r = __pyx_v_cp_size;
    goto __pyx_L0;
  }
  __pyx_L2:;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

static void __pyx_f_10ncrypt_rsa__rsa_callback(int __pyx_v_type,int __pyx_v_num,void (*__pyx_v_cb_arg)) {
  PyObject *__pyx_v_cb;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  __pyx_v_cb = Py_None; Py_INCREF(Py_None);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":113 */
  __pyx_1 = (PyObject *)__pyx_v_cb_arg;
  Py_INCREF(__pyx_1);
  Py_DECREF(__pyx_v_cb);
  __pyx_v_cb = __pyx_1;
  __pyx_1 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":114 */
  __pyx_1 = PyInt_FromLong(__pyx_v_type); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(__pyx_v_num); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_v_cb, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_WriteUnraisable("ncrypt_rsa._rsa_callback");
  __pyx_L0:;
  Py_DECREF(__pyx_v_cb);
}

static int __pyx_f_10ncrypt_rsa_6RSAKey___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_10ncrypt_rsa_6RSAKey___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return -1;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":121 */
  ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa = RSA_new();

  __pyx_r = 0;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static void __pyx_f_10ncrypt_rsa_6RSAKey___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_f_10ncrypt_rsa_6RSAKey___dealloc__(PyObject *__pyx_v_self) {
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":124 */
  RSA_free(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);

  Py_DECREF(__pyx_v_self);
}

static int __pyx_f_10ncrypt_rsa_6RSAKey___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_10ncrypt_rsa_6RSAKey___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return -1;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":127 */

  __pyx_r = 0;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static void __pyx_f_10ncrypt_rsa_6RSAKey_loadCPublicKey(struct __pyx_obj_10ncrypt_rsa_RSAKey *__pyx_v_self,RSA (*__pyx_v_r)) {
  RSA (*__pyx_v_newrsa);
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":131 */
  __pyx_v_newrsa = RSAPublicKey_dup(__pyx_v_r);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":132 */
  RSA_free(__pyx_v_self->rsa);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":133 */
  __pyx_v_self->rsa = __pyx_v_newrsa;

  Py_DECREF(__pyx_v_self);
}

static void __pyx_f_10ncrypt_rsa_6RSAKey_loadCPrivateKey(struct __pyx_obj_10ncrypt_rsa_RSAKey *__pyx_v_self,RSA (*__pyx_v_r)) {
  RSA (*__pyx_v_newrsa);
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":137 */
  __pyx_v_newrsa = RSAPrivateKey_dup(__pyx_v_r);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":138 */
  RSA_free(__pyx_v_self->rsa);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":139 */
  __pyx_v_self->rsa = __pyx_v_newrsa;

  Py_DECREF(__pyx_v_self);
}

static PyObject *__pyx_n_get;
static PyObject *__pyx_n_e;
static PyObject *__pyx_n_callback;

static PyObject *__pyx_k12p;

static char (__pyx_k12[]) = "key generation failed";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_generate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_generate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bits = 0;
  PyObject *__pyx_v_kw = 0;
  RSA (*__pyx_v_newKey);
  int __pyx_v_e;
  PyObject *__pyx_v_callback;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  static char *__pyx_argnames[] = {"bits",0};
  __pyx_v_bits = __pyx_k3;
  if (__Pyx_GetStarArgs(&__pyx_args, &__pyx_kwds, __pyx_argnames, 1, 0, &__pyx_v_kw) < 0) return 0;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "|O", __pyx_argnames, &__pyx_v_bits)) {
    Py_XDECREF(__pyx_args);
    Py_XDECREF(__pyx_kwds);
    Py_XDECREF(__pyx_v_kw);
    return 0;
  }
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_bits);
  __pyx_v_callback = Py_None; Py_INCREF(Py_None);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":145 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_kw, __pyx_n_get); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(5); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; goto __pyx_L1;}
  Py_INCREF(__pyx_n_e);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_n_e);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_4 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_e = __pyx_4;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":146 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_kw, __pyx_n_get); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; goto __pyx_L1;}
  Py_INCREF(__pyx_n_callback);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_n_callback);
  Py_INCREF(Py_None);
  PyTuple_SET_ITEM(__pyx_3, 1, Py_None);
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_callback);
  __pyx_v_callback = __pyx_2;
  __pyx_2 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":147 */
  __pyx_4 = __pyx_v_callback == Py_None;
  if (__pyx_4) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":148 */
    __pyx_4 = PyInt_AsLong(__pyx_v_bits); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; goto __pyx_L1;}
    __pyx_v_newKey = RSA_generate_key(__pyx_4,__pyx_v_e,0,0);
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":150 */
    __pyx_4 = PyInt_AsLong(__pyx_v_bits); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; goto __pyx_L1;}
    __pyx_v_newKey = RSA_generate_key(__pyx_4,__pyx_v_e,__pyx_f_10ncrypt_rsa__rsa_callback,((void (*))__pyx_v_callback));
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":151 */
  __pyx_4 = (__pyx_v_newKey == 0);
  if (__pyx_4) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":152 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k12p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":153 */
  RSA_free(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":154 */
  ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa = __pyx_v_newKey;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.generate");
  __pyx_r = 0;
  __pyx_L0:;
  Py_XDECREF(__pyx_v_kw);
  Py_DECREF(__pyx_v_callback);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_bits);
  Py_XDECREF(__pyx_args);
  Py_XDECREF(__pyx_kwds);
  return __pyx_r;
}

static PyObject *__pyx_k13p;

static char (__pyx_k13[]) = "key not initialized";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_size(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_size(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":157 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->n != 0));
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":158 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k13p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":159 */
  __pyx_2 = PyInt_FromLong(RSA_size(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.size");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k14p;
static PyObject *__pyx_k15p;

static char (__pyx_k14[]) = "private key not initialized";
static char (__pyx_k15[]) = "primes not initialized";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_check(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_check(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  RSA (*__pyx_v_r);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":163 */
  __pyx_v_r = ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":164 */
  __pyx_1 = (!(__pyx_v_r->e != 0));
  if (!__pyx_1) {
    __pyx_1 = (!(__pyx_v_r->n != 0));
    if (!__pyx_1) {
      __pyx_1 = (!(__pyx_v_r->d != 0));
    }
  }
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":165 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k14p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":166 */
  __pyx_1 = (!(__pyx_v_r->p != 0));
  if (!__pyx_1) {
    __pyx_1 = (!(__pyx_v_r->q != 0));
  }
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":167 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k15p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":168 */
  __pyx_2 = PyInt_FromLong(RSA_check_key(__pyx_v_r)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.check");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k16p;
static PyObject *__pyx_k17p;

static char (__pyx_k16[]) = "private key not initialized";
static char (__pyx_k17[]) = "unable to enable blinding";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_enableBlinding(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_enableBlinding(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_enable = 0;
  int __pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {"enable",0};
  __pyx_v_enable = __pyx_k4;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "|O", __pyx_argnames, &__pyx_v_enable)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_enable);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":171 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->d != 0));
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":172 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k16p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":174 */
  __pyx_1 = PyObject_IsTrue(__pyx_v_enable); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; goto __pyx_L1;}
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":175 */
    __pyx_v_result = RSA_blinding_on(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa,0);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":176 */
    __pyx_1 = (!__pyx_v_result);
    if (__pyx_1) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":177 */
      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; goto __pyx_L1;}
      __Pyx_Raise(__pyx_2, __pyx_k17p, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; goto __pyx_L1;}
      goto __pyx_L4;
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  /*else*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":179 */
    RSA_blinding_off(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);
  }
  __pyx_L3:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.enableBlinding");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_enable);
  return __pyx_r;
}

static PyObject *__pyx_k18p;

static char (__pyx_k18[]) = "'n' not initialized";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getN(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getN(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":182 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->n != 0));
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":183 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k18p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":184 */
  __pyx_2 = BNToLong(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->n); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.getN");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k19p;

static char (__pyx_k19[]) = "'e' not initialized";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getE(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getE(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":187 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->e != 0));
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":188 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k19p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":189 */
  __pyx_2 = BNToLong(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->e); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.getE");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k20p;

static char (__pyx_k20[]) = "'d' not initialized";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getD(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getD(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":192 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->d != 0));
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":193 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k20p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":194 */
  __pyx_2 = BNToLong(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->d); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.getD");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k21p;

static char (__pyx_k21[]) = "'p' not initialized";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getP(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getP(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":197 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->p != 0));
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":198 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k21p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":199 */
  __pyx_2 = BNToLong(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->p); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.getP");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k22p;

static char (__pyx_k22[]) = "'q' not initialized";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getQ(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getQ(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":202 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->q != 0));
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":203 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k22p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":204 */
  __pyx_2 = BNToLong(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->q); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.getQ");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_False;

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_hasPublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_hasPublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":207 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->n != 0));
  if (__pyx_1) {
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_False); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; goto __pyx_L1;}
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":208 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->e != 0));
  if (__pyx_1) {
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_False); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; goto __pyx_L1;}
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":209 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_True); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.hasPublicKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_hasPrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_hasPrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":212 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->d != 0));
  if (__pyx_1) {
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_False); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; goto __pyx_L1;}
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":213 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_True); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.hasPrivateKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k23p;

static char (__pyx_k23[]) = "key not initialized";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getPublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getPublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  RSA (*__pyx_v_r);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":217 */
  __pyx_v_r = ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":218 */
  __pyx_1 = (!(__pyx_v_r->n != 0));
  if (!__pyx_1) {
    __pyx_1 = (!(__pyx_v_r->e != 0));
  }
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":219 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k23p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":220 */
  __pyx_2 = BNToLong(__pyx_v_r->n); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; goto __pyx_L1;}
  __pyx_3 = BNToLong(__pyx_v_r->e); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_3);
  __pyx_2 = 0;
  __pyx_3 = 0;
  __pyx_r = __pyx_4;
  __pyx_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.getPublicKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k24p;
static PyObject *__pyx_k25p;

static char (__pyx_k24[]) = "private key not initialized";
static char (__pyx_k25[]) = "private key not initialized";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getPrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_getPrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  RSA (*__pyx_v_r);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_9 = 0;
  PyObject *__pyx_10 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":225 */
  __pyx_v_r = ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":226 */
  __pyx_1 = (!(__pyx_v_r->n != 0));
  if (!__pyx_1) {
    __pyx_1 = (!(__pyx_v_r->e != 0));
    if (!__pyx_1) {
      __pyx_1 = (!(__pyx_v_r->d != 0));
    }
  }
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":227 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k24p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":228 */
  __pyx_1 = (!(__pyx_v_r->p != 0));
  if (!__pyx_1) {
    __pyx_1 = (!(__pyx_v_r->q != 0));
    if (!__pyx_1) {
      __pyx_1 = (!(__pyx_v_r->dmp1 != 0));
      if (!__pyx_1) {
        __pyx_1 = (!(__pyx_v_r->dmq1 != 0));
        if (!__pyx_1) {
          __pyx_1 = (!(__pyx_v_r->iqmp != 0));
        }
      }
    }
  }
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":229 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k25p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":230 */
  __pyx_2 = BNToLong(__pyx_v_r->n); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; goto __pyx_L1;}
  __pyx_3 = BNToLong(__pyx_v_r->e); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; goto __pyx_L1;}
  __pyx_4 = BNToLong(__pyx_v_r->d); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; goto __pyx_L1;}
  __pyx_5 = BNToLong(__pyx_v_r->p); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; goto __pyx_L1;}
  __pyx_6 = BNToLong(__pyx_v_r->q); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; goto __pyx_L1;}
  __pyx_7 = BNToLong(__pyx_v_r->dmp1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; goto __pyx_L1;}
  __pyx_8 = BNToLong(__pyx_v_r->dmq1); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; goto __pyx_L1;}
  __pyx_9 = BNToLong(__pyx_v_r->iqmp); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; goto __pyx_L1;}
  __pyx_10 = PyTuple_New(8); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_10, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_10, 1, __pyx_3);
  PyTuple_SET_ITEM(__pyx_10, 2, __pyx_4);
  PyTuple_SET_ITEM(__pyx_10, 3, __pyx_5);
  PyTuple_SET_ITEM(__pyx_10, 4, __pyx_6);
  PyTuple_SET_ITEM(__pyx_10, 5, __pyx_7);
  PyTuple_SET_ITEM(__pyx_10, 6, __pyx_8);
  PyTuple_SET_ITEM(__pyx_10, 7, __pyx_9);
  __pyx_2 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_5 = 0;
  __pyx_6 = 0;
  __pyx_7 = 0;
  __pyx_8 = 0;
  __pyx_9 = 0;
  __pyx_r = __pyx_10;
  __pyx_10 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  Py_XDECREF(__pyx_9);
  Py_XDECREF(__pyx_10);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.getPrivateKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k26p;

static char (__pyx_k26[]) = "invalid public key";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_loadPublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_loadPublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_publicKey = 0;
  BIGNUM (*__pyx_v_bn_n);
  BIGNUM (*__pyx_v_bn_e);
  int __pyx_v_result1;
  int __pyx_v_result2;
  PyObject *__pyx_v_n;
  PyObject *__pyx_v_e;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  BIGNUM (*__pyx_3);
  BIGNUM (*__pyx_4);
  int __pyx_5;
  BIGNUM (*__pyx_6);
  BIGNUM (*__pyx_7);
  static char *__pyx_argnames[] = {"publicKey",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_publicKey)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_publicKey);
  __pyx_v_n = Py_None; Py_INCREF(Py_None);
  __pyx_v_e = Py_None; Py_INCREF(Py_None);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":237 */
  __pyx_1 = PyObject_GetIter(__pyx_v_publicKey); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; goto __pyx_L1;}
  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; goto __pyx_L1;}
  Py_DECREF(__pyx_v_n);
  __pyx_v_n = __pyx_2;
  __pyx_2 = 0;
  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; goto __pyx_L1;}
  Py_DECREF(__pyx_v_e);
  __pyx_v_e = __pyx_2;
  __pyx_2 = 0;
  if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":238 */
  __pyx_3 = BN_new();
  __pyx_4 = BN_new();
  __pyx_v_bn_n = __pyx_3;
  __pyx_v_bn_e = __pyx_4;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":239 */
  __pyx_v_result1 = LongToBN(__pyx_v_n,__pyx_v_bn_n);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":240 */
  __pyx_v_result2 = LongToBN(__pyx_v_e,__pyx_v_bn_e);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":241 */
  __pyx_5 = (__pyx_v_result1 < 0);
  if (!__pyx_5) {
    __pyx_5 = (__pyx_v_result2 < 0);
  }
  if (__pyx_5) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":242 */
    BN_free(__pyx_v_bn_n);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":243 */
    BN_free(__pyx_v_bn_e);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":244 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k26p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":245 */
  RSA_free(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":246 */
  ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa = RSA_new();

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":247 */
  __pyx_6 = __pyx_v_bn_n;
  __pyx_7 = __pyx_v_bn_e;
  ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->n = __pyx_6;
  ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->e = __pyx_7;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.loadPublicKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_n);
  Py_DECREF(__pyx_v_e);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_publicKey);
  return __pyx_r;
}

static PyObject *__pyx_n_len;
static PyObject *__pyx_n_TypeError;

static PyObject *__pyx_k27p;
static PyObject *__pyx_k28p;

static char (__pyx_k27[]) = "private key must have 8 elements";
static char (__pyx_k28[]) = "invalid private key";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_loadPrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_loadPrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_privateKey = 0;
  BIGNUM (*(__pyx_v_bn[8]));
  int __pyx_v_i;
  int __pyx_v_result;
  RSA (*__pyx_v_r);
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  BIGNUM (*__pyx_5);
  BIGNUM (*__pyx_6);
  BIGNUM (*__pyx_7);
  BIGNUM (*__pyx_8);
  BIGNUM (*__pyx_9);
  static char *__pyx_argnames[] = {"privateKey",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_privateKey)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_privateKey);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":252 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; goto __pyx_L1;}
  Py_INCREF(__pyx_v_privateKey);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_privateKey);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyInt_FromLong(8); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_3, __pyx_1, &__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; goto __pyx_L1;}
  __pyx_4 = __pyx_4 != 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_4) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":253 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k27p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":254 */
  for (__pyx_v_i = 0; __pyx_v_i < 8; ++__pyx_v_i) {
    (__pyx_v_bn[__pyx_v_i]) = BN_new();
  }

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":255 */
  for (__pyx_v_i = 0; __pyx_v_i < 8; ++__pyx_v_i) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":256 */
    __pyx_3 = PyInt_FromLong(__pyx_v_i); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; goto __pyx_L1;}
    __pyx_1 = PyObject_GetItem(__pyx_v_privateKey, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_v_result = LongToBN(__pyx_1,(__pyx_v_bn[__pyx_v_i]));
    Py_DECREF(__pyx_1); __pyx_1 = 0;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":257 */
    __pyx_4 = (__pyx_v_result < 0);
    if (__pyx_4) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":258 */
      for (__pyx_v_i = 0; __pyx_v_i < 8; ++__pyx_v_i) {

        /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":259 */
        BN_free((__pyx_v_bn[__pyx_v_i]));
      }

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":260 */
      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
      __Pyx_Raise(__pyx_2, __pyx_k28p, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
      goto __pyx_L7;
    }
    __pyx_L7:;
  }

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":261 */
  RSA_free(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":262 */
  ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa = RSA_new();

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":264 */
  __pyx_v_r = ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":265 */
  __pyx_5 = (__pyx_v_bn[0]);
  __pyx_6 = (__pyx_v_bn[1]);
  __pyx_7 = (__pyx_v_bn[2]);
  __pyx_8 = (__pyx_v_bn[3]);
  __pyx_9 = (__pyx_v_bn[4]);
  __pyx_v_r->n = __pyx_5;
  __pyx_v_r->e = __pyx_6;
  __pyx_v_r->d = __pyx_7;
  __pyx_v_r->p = __pyx_8;
  __pyx_v_r->q = __pyx_9;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":266 */
  __pyx_5 = (__pyx_v_bn[5]);
  __pyx_6 = (__pyx_v_bn[6]);
  __pyx_7 = (__pyx_v_bn[7]);
  __pyx_v_r->dmp1 = __pyx_5;
  __pyx_v_r->dmq1 = __pyx_6;
  __pyx_v_r->iqmp = __pyx_7;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.loadPrivateKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_privateKey);
  return __pyx_r;
}

static PyObject *__pyx_k29p;

static char (__pyx_k29[]) = "unknown padding mode";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_paddingSize(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_paddingSize(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_paddingMode = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  int __pyx_2;
  static char *__pyx_argnames[] = {"paddingMode",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_paddingMode)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_paddingMode);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":269 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_PADDING_PKCS1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_v_paddingMode, __pyx_1, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; goto __pyx_L1;}
  __pyx_2 = __pyx_2 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_2) {
    __pyx_1 = PyInt_FromLong(12); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; goto __pyx_L1;}
    __pyx_r = __pyx_1;
    __pyx_1 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":270 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_PADDING_PKCS1_OAEP); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_v_paddingMode, __pyx_1, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; goto __pyx_L1;}
  __pyx_2 = __pyx_2 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_2) {
    __pyx_1 = PyInt_FromLong(42); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; goto __pyx_L1;}
    __pyx_r = __pyx_1;
    __pyx_1 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":271 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; goto __pyx_L1;}
  __Pyx_Raise(__pyx_1, __pyx_k29p, 0);
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; goto __pyx_L1;}

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.paddingSize");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_paddingMode);
  return __pyx_r;
}

static PyObject *__pyx_n_size;
static PyObject *__pyx_n_paddingSize;

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_maxInputSize(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_maxInputSize(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_paddingMode = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"paddingMode",0};
  __pyx_v_paddingMode = __pyx_k5;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "|O", __pyx_argnames, &__pyx_v_paddingMode)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_paddingMode);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":274 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_size); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
  __pyx_2 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_paddingSize); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
  Py_INCREF(__pyx_v_paddingMode);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_paddingMode);
  __pyx_4 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_1 = PyNumber_Subtract(__pyx_2, __pyx_4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.maxInputSize");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_paddingMode);
  return __pyx_r;
}

static PyObject *__pyx_n_maxInputSize;

static PyObject *__pyx_k30p;
static PyObject *__pyx_k31p;
static PyObject *__pyx_k32p;
static PyObject *__pyx_k33p;
static PyObject *__pyx_k34p;

static char (__pyx_k30[]) = "unknown padding mode";
static char (__pyx_k31[]) = "public key not initialized";
static char (__pyx_k32[]) = "encryption input is too long, maxsize=%d";
static char (__pyx_k33[]) = "'data' must be a string";
static char (__pyx_k34[]) = "RSA encryption failed";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_encrypt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_encrypt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_paddingMode = 0;
  int __pyx_v_paddingCode;
  PyObject *__pyx_v_size;
  PyObject *__pyx_v_maxSize;
  int __pyx_v_result;
  unsigned char (*__pyx_v_plainText);
  int __pyx_v_plainTextLen;
  unsigned char (*__pyx_v_cipherText);
  int __pyx_v_cipherTextLen;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  int __pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"data","paddingMode",0};
  __pyx_v_paddingMode = __pyx_k6;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O|O", __pyx_argnames, &__pyx_v_data, &__pyx_v_paddingMode)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_data);
  Py_INCREF(__pyx_v_paddingMode);
  __pyx_v_size = Py_None; Py_INCREF(Py_None);
  __pyx_v_maxSize = Py_None; Py_INCREF(Py_None);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":278 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_PADDING_PKCS1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_v_paddingMode, __pyx_1, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; goto __pyx_L1;}
  __pyx_2 = __pyx_2 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_2) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":279 */
    __pyx_v_paddingCode = RSA_PKCS1_PADDING;
    goto __pyx_L2;
  }
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_PADDING_PKCS1_OAEP); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_v_paddingMode, __pyx_1, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; goto __pyx_L1;}
  __pyx_2 = __pyx_2 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_2) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":281 */
    __pyx_v_paddingCode = RSA_PKCS1_OAEP_PADDING;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":283 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k30p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":285 */
  __pyx_2 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->n != 0));
  if (!__pyx_2) {
    __pyx_2 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->e != 0));
  }
  if (__pyx_2) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":286 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k31p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":288 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_size); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
  __pyx_3 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_size);
  __pyx_v_size = __pyx_3;
  __pyx_3 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":289 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_maxInputSize); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; goto __pyx_L1;}
  Py_INCREF(__pyx_v_paddingMode);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_paddingMode);
  __pyx_4 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_maxSize);
  __pyx_v_maxSize = __pyx_4;
  __pyx_4 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":290 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; goto __pyx_L1;}
  Py_INCREF(__pyx_v_data);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_data);
  __pyx_4 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (PyObject_Cmp(__pyx_4, __pyx_v_maxSize, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; goto __pyx_L1;}
  __pyx_2 = __pyx_2 > 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (__pyx_2) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":291 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; goto __pyx_L1;}
    __pyx_3 = PyNumber_Remainder(__pyx_k32p, __pyx_v_maxSize); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_3, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; goto __pyx_L1;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":297 */
  __pyx_v_result = PyString_AsStringAndSize(__pyx_v_data,((char (*(*)))(&__pyx_v_plainText)),(&__pyx_v_plainTextLen));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":298 */
  __pyx_2 = (__pyx_v_result < 0);
  if (__pyx_2) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":299 */
    __pyx_4 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; goto __pyx_L1;}
    __Pyx_Raise(__pyx_4, __pyx_k33p, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; goto __pyx_L1;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":302 */
  __pyx_2 = PyInt_AsLong(__pyx_v_size); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; goto __pyx_L1;}
  __pyx_v_cipherText = ((unsigned char (*))malloc(__pyx_2));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":305 */
  __pyx_v_cipherTextLen = RSA_public_encrypt(__pyx_v_plainTextLen,__pyx_v_plainText,__pyx_v_cipherText,((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa,__pyx_v_paddingCode);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":307 */
  __pyx_2 = (__pyx_v_cipherTextLen < 0);
  if (__pyx_2) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":308 */
    free(__pyx_v_cipherText);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":309 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 309; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k34p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 309; goto __pyx_L1;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":310 */
  __pyx_3 = PyInt_FromLong(__pyx_v_cipherTextLen); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_3, __pyx_v_size, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; goto __pyx_L1;}
  __pyx_2 = __pyx_2 == 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__pyx_2) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; goto __pyx_L1;}
  }

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":312 */
  /*try:*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":313 */
    __pyx_4 = PyString_FromStringAndSize(((char (*))__pyx_v_cipherText),__pyx_v_cipherTextLen); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; goto __pyx_L8;}
    __pyx_r = __pyx_4;
    __pyx_4 = 0;
    goto __pyx_L7;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L9;
    __pyx_L7: __pyx_why = 3; goto __pyx_L9;
    __pyx_L8: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_1); __pyx_1 = 0;
      Py_XDECREF(__pyx_3); __pyx_3 = 0;
      Py_XDECREF(__pyx_4); __pyx_4 = 0;
      PyErr_Fetch(&__pyx_1, &__pyx_3, &__pyx_4);
      __pyx_2 = __pyx_lineno;
      goto __pyx_L9;
    }
    __pyx_L9:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":315 */
    free(__pyx_v_cipherText);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_1, __pyx_3, __pyx_4);
        __pyx_lineno = __pyx_2;
        __pyx_1 = 0;
        __pyx_3 = 0;
        __pyx_4 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.encrypt");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_size);
  Py_DECREF(__pyx_v_maxSize);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_data);
  Py_DECREF(__pyx_v_paddingMode);
  return __pyx_r;
}

static PyObject *__pyx_k35p;
static PyObject *__pyx_k36p;
static PyObject *__pyx_k37p;
static PyObject *__pyx_k38p;

static char (__pyx_k35[]) = "unknown padding mode";
static char (__pyx_k36[]) = "private key not initialized";
static char (__pyx_k37[]) = "'data' must be a string";
static char (__pyx_k38[]) = "RSA decryption failed";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_decrypt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_decrypt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_paddingMode = 0;
  int __pyx_v_paddingCode;
  PyObject *__pyx_v_size;
  int __pyx_v_result;
  unsigned char (*__pyx_v_cipherText);
  int __pyx_v_cipherTextLen;
  unsigned char (*__pyx_v_plainText);
  int __pyx_v_plainTextLen;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  int __pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"data","paddingMode",0};
  __pyx_v_paddingMode = __pyx_k7;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O|O", __pyx_argnames, &__pyx_v_data, &__pyx_v_paddingMode)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_data);
  Py_INCREF(__pyx_v_paddingMode);
  __pyx_v_size = Py_None; Py_INCREF(Py_None);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":319 */
  __pyx_v_paddingCode = (-1);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":320 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_PADDING_PKCS1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 320; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_v_paddingMode, __pyx_1, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 320; goto __pyx_L1;}
  __pyx_2 = __pyx_2 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_2) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":321 */
    __pyx_v_paddingCode = RSA_PKCS1_PADDING;
    goto __pyx_L2;
  }
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_PADDING_PKCS1_OAEP); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_v_paddingMode, __pyx_1, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; goto __pyx_L1;}
  __pyx_2 = __pyx_2 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_2) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":323 */
    __pyx_v_paddingCode = RSA_PKCS1_OAEP_PADDING;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":325 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k35p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; goto __pyx_L1;}
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":327 */
  __pyx_2 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->n != 0));
  if (!__pyx_2) {
    __pyx_2 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->e != 0));
    if (!__pyx_2) {
      __pyx_2 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->d != 0));
    }
  }
  if (__pyx_2) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":328 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k36p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":330 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_size); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; goto __pyx_L1;}
  __pyx_3 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_size);
  __pyx_v_size = __pyx_3;
  __pyx_3 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":336 */
  __pyx_v_result = PyString_AsStringAndSize(__pyx_v_data,((char (*(*)))(&__pyx_v_cipherText)),(&__pyx_v_cipherTextLen));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":337 */
  __pyx_2 = (__pyx_v_result < 0);
  if (__pyx_2) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":338 */
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k37p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; goto __pyx_L1;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":342 */
  __pyx_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_size); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
  __pyx_1 = PyObject_CallObject(__pyx_3, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_2 = PyInt_AsLong(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_v_plainText = ((unsigned char (*))malloc(__pyx_2));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":344 */
  __pyx_v_plainTextLen = RSA_private_decrypt(__pyx_v_cipherTextLen,__pyx_v_cipherText,__pyx_v_plainText,((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa,__pyx_v_paddingCode);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":346 */
  __pyx_2 = (__pyx_v_plainTextLen < 0);
  if (__pyx_2) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":347 */
    free(__pyx_v_plainText);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":348 */
    __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; goto __pyx_L1;}
    __Pyx_Raise(__pyx_3, __pyx_k38p, 0);
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; goto __pyx_L1;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":350 */
  /*try:*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":351 */
    __pyx_1 = PyString_FromStringAndSize(((char (*))__pyx_v_plainText),__pyx_v_plainTextLen); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; goto __pyx_L7;}
    __pyx_r = __pyx_1;
    __pyx_1 = 0;
    goto __pyx_L6;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L8;
    __pyx_L6: __pyx_why = 3; goto __pyx_L8;
    __pyx_L7: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_3); __pyx_3 = 0;
      Py_XDECREF(__pyx_1); __pyx_1 = 0;
      PyErr_Fetch(&__pyx_3, &__pyx_1, &__pyx_4);
      __pyx_2 = __pyx_lineno;
      goto __pyx_L8;
    }
    __pyx_L8:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":353 */
    free(__pyx_v_plainText);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_3, __pyx_1, __pyx_4);
        __pyx_lineno = __pyx_2;
        __pyx_3 = 0;
        __pyx_1 = 0;
        __pyx_4 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.decrypt");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_size);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_data);
  Py_DECREF(__pyx_v_paddingMode);
  return __pyx_r;
}

static PyObject *__pyx_n_nid;

static PyObject *__pyx_k39p;
static PyObject *__pyx_k40p;
static PyObject *__pyx_k41p;

static char (__pyx_k39[]) = "private key not initialized";
static char (__pyx_k40[]) = "'digest' must be a string";
static char (__pyx_k41[]) = "RSA sign failed";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_sign(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_sign(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_digest = 0;
  PyObject *__pyx_v_digestType = 0;
  int __pyx_v_nid;
  int __pyx_v_result;
  unsigned char (*__pyx_v_digestBuf);
  unsigned int __pyx_v_digestLen;
  int __pyx_v_size;
  unsigned char (*__pyx_v_sigBuf);
  unsigned int __pyx_v_sigLen;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"digest","digestType",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO", __pyx_argnames, &__pyx_v_digest, &__pyx_v_digestType)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_digest);
  Py_INCREF(__pyx_v_digestType);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":356 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->n != 0));
  if (!__pyx_1) {
    __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->e != 0));
    if (!__pyx_1) {
      __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->d != 0));
    }
  }
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":357 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k39p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":360 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_digestType, __pyx_n_nid); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; goto __pyx_L1;}
  __pyx_3 = PyObject_CallObject(__pyx_2, 0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyInt_AsLong(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_v_nid = __pyx_1;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":366 */
  __pyx_v_result = PyString_AsStringAndSize(__pyx_v_digest,((char (*(*)))(&__pyx_v_digestBuf)),((int (*))(&__pyx_v_digestLen)));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":368 */
  __pyx_1 = (__pyx_v_result < 0);
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":369 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k40p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":372 */
  __pyx_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_size); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; goto __pyx_L1;}
  __pyx_2 = PyObject_CallObject(__pyx_3, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_1 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_size = __pyx_1;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":376 */
  __pyx_v_sigLen = __pyx_v_size;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":377 */
  __pyx_v_sigBuf = ((unsigned char (*))malloc(__pyx_v_sigLen));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":379 */
  __pyx_v_result = RSA_sign(__pyx_v_nid,__pyx_v_digestBuf,__pyx_v_digestLen,__pyx_v_sigBuf,(&__pyx_v_sigLen),((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":380 */
  __pyx_1 = (!__pyx_v_result);
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":381 */
    free(__pyx_v_sigBuf);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":382 */
    __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; goto __pyx_L1;}
    __Pyx_Raise(__pyx_3, __pyx_k41p, 0);
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; goto __pyx_L1;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":384 */
  /*try:*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":385 */
    __pyx_2 = PyString_FromStringAndSize(((char (*))__pyx_v_sigBuf),((int )__pyx_v_sigLen)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; goto __pyx_L6;}
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L5;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L7;
    __pyx_L5: __pyx_why = 3; goto __pyx_L7;
    __pyx_L6: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_3); __pyx_3 = 0;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      PyErr_Fetch(&__pyx_3, &__pyx_2, &__pyx_4);
      __pyx_1 = __pyx_lineno;
      goto __pyx_L7;
    }
    __pyx_L7:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":387 */
    free(__pyx_v_sigBuf);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_3, __pyx_2, __pyx_4);
        __pyx_lineno = __pyx_1;
        __pyx_3 = 0;
        __pyx_2 = 0;
        __pyx_4 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.sign");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_digest);
  Py_DECREF(__pyx_v_digestType);
  return __pyx_r;
}

static PyObject *__pyx_k42p;
static PyObject *__pyx_k43p;
static PyObject *__pyx_k44p;
static PyObject *__pyx_k45p;

static char (__pyx_k42[]) = "public key not initialized";
static char (__pyx_k43[]) = "'digest' must be a string";
static char (__pyx_k44[]) = "'signature' must be a string";
static char (__pyx_k45[]) = "RSA verify failed";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_verify(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_verify(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_signature = 0;
  PyObject *__pyx_v_digest = 0;
  PyObject *__pyx_v_digestType = 0;
  int __pyx_v_nid;
  int __pyx_v_result;
  unsigned char (*__pyx_v_digestBuf);
  unsigned int __pyx_v_digestLen;
  unsigned char (*__pyx_v_sigBuf);
  unsigned int __pyx_v_sigLen;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {"signature","digest","digestType",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOO", __pyx_argnames, &__pyx_v_signature, &__pyx_v_digest, &__pyx_v_digestType)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_signature);
  Py_INCREF(__pyx_v_digest);
  Py_INCREF(__pyx_v_digestType);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":390 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->n != 0));
  if (!__pyx_1) {
    __pyx_1 = (!(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa->e != 0));
  }
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":391 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k42p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":394 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_digestType, __pyx_n_nid); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; goto __pyx_L1;}
  __pyx_3 = PyObject_CallObject(__pyx_2, 0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyInt_AsLong(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_v_nid = __pyx_1;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":400 */
  __pyx_v_result = PyString_AsStringAndSize(__pyx_v_digest,((char (*(*)))(&__pyx_v_digestBuf)),((int (*))(&__pyx_v_digestLen)));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":402 */
  __pyx_1 = (__pyx_v_result < 0);
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":403 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k43p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":407 */
  __pyx_v_result = PyString_AsStringAndSize(__pyx_v_signature,((char (*(*)))(&__pyx_v_sigBuf)),((int (*))(&__pyx_v_sigLen)));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":409 */
  __pyx_1 = (__pyx_v_result < 0);
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":410 */
    __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; goto __pyx_L1;}
    __Pyx_Raise(__pyx_3, __pyx_k44p, 0);
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; goto __pyx_L1;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":412 */
  __pyx_v_result = RSA_verify(__pyx_v_nid,__pyx_v_digestBuf,__pyx_v_digestLen,__pyx_v_sigBuf,__pyx_v_sigLen,((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":413 */
  __pyx_1 = (!__pyx_v_result);
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":414 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k45p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; goto __pyx_L1;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.verify");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_signature);
  Py_DECREF(__pyx_v_digest);
  Py_DECREF(__pyx_v_digestType);
  return __pyx_r;
}

static PyObject *__pyx_k46p;
static PyObject *__pyx_k47p;

static char (__pyx_k46[]) = "a string is expected";
static char (__pyx_k47[]) = "unable to load object from data";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_fromDER_PrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_fromDER_PrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_data = 0;
  RSA (*__pyx_v_newrsa);
  char (*__pyx_v_p);
  int __pyx_v_dataLen;
  int __pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {"data",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_data)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_data);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":420 */
  __pyx_v_result = PyString_AsStringAndSize(__pyx_v_data,(&__pyx_v_p),(&__pyx_v_dataLen));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":421 */
  __pyx_1 = (__pyx_v_result < 0);
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":422 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k46p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":423 */
  __pyx_v_newrsa = d2i_RSAPrivateKey(0,((unsigned char (*(*)))(&__pyx_v_p)),__pyx_v_dataLen);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":424 */
  __pyx_1 = (!(__pyx_v_newrsa != 0));
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":425 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k47p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":426 */
  RSA_free(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":427 */
  ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa = __pyx_v_newrsa;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.fromDER_PrivateKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_data);
  return __pyx_r;
}

static PyObject *__pyx_n_hasPrivateKey;
static PyObject *__pyx_n_MemoryError;

static PyObject *__pyx_k48p;
static PyObject *__pyx_k49p;
static PyObject *__pyx_k50p;

static char (__pyx_k48[]) = "private key not initialized";
static char (__pyx_k49[]) = "error in private key data";
static char (__pyx_k50[]) = "unable to allocate string";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_toDER_PrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_toDER_PrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_len;
  int __pyx_v_len1;
  PyObject (*__pyx_v_derStr);
  char (*__pyx_v_p);
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  int __pyx_4;
  PyObject *__pyx_5 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":432 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_hasPrivateKey); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; goto __pyx_L1;}
  __pyx_2 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_3 = PyObject_IsTrue(__pyx_2); if (__pyx_3 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = (!__pyx_3);
  if (__pyx_4) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":433 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k48p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":434 */
  __pyx_v_len = i2d_RSAPrivateKey(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa,0);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":435 */
  __pyx_3 = (__pyx_v_len < 0);
  if (__pyx_3) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":436 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 436; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k49p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 436; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":437 */
  __pyx_v_derStr = PyString_FromStringAndSize(0,__pyx_v_len);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":438 */
  __pyx_4 = (__pyx_v_derStr == 0);
  if (__pyx_4) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":439 */
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_MemoryError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k50p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; goto __pyx_L1;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":441 */
  __pyx_v_p = PyString_AsString(__pyx_v_derStr);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":442 */
  /*try:*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":443 */
    __pyx_v_len1 = i2d_RSAPrivateKey(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa,((unsigned char (*(*)))(&__pyx_v_p)));

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":444 */
    if (!(__pyx_v_len == __pyx_v_len1)) {
      PyErr_SetNone(PyExc_AssertionError);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; goto __pyx_L6;}
    }

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":445 */
    __pyx_2 = (PyObject *)__pyx_v_derStr;
    Py_INCREF(__pyx_2);
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L5;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L7;
    __pyx_L5: __pyx_why = 3; goto __pyx_L7;
    __pyx_L6: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_1); __pyx_1 = 0;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      PyErr_Fetch(&__pyx_1, &__pyx_2, &__pyx_5);
      __pyx_3 = __pyx_lineno;
      goto __pyx_L7;
    }
    __pyx_L7:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":447 */
    Py_DECREF(__pyx_v_derStr);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_1, __pyx_2, __pyx_5);
        __pyx_lineno = __pyx_3;
        __pyx_1 = 0;
        __pyx_2 = 0;
        __pyx_5 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.toDER_PrivateKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k51p;
static PyObject *__pyx_k52p;

static char (__pyx_k51[]) = "a string is expected";
static char (__pyx_k52[]) = "unable to load object from data";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_fromDER_PublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_fromDER_PublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_data = 0;
  RSA (*__pyx_v_newrsa);
  char (*__pyx_v_p);
  int __pyx_v_dataLen;
  int __pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {"data",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_data)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_data);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":453 */
  __pyx_v_result = PyString_AsStringAndSize(__pyx_v_data,(&__pyx_v_p),(&__pyx_v_dataLen));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":454 */
  __pyx_1 = (__pyx_v_result < 0);
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":455 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k51p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":456 */
  __pyx_v_newrsa = d2i_RSAPublicKey(0,((unsigned char (*(*)))(&__pyx_v_p)),__pyx_v_dataLen);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":457 */
  __pyx_1 = (!(__pyx_v_newrsa != 0));
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":458 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k52p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":459 */
  RSA_free(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":460 */
  ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa = __pyx_v_newrsa;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.fromDER_PublicKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_data);
  return __pyx_r;
}

static PyObject *__pyx_n_hasPublicKey;

static PyObject *__pyx_k53p;
static PyObject *__pyx_k54p;
static PyObject *__pyx_k55p;

static char (__pyx_k53[]) = "public key not initialized";
static char (__pyx_k54[]) = "error in public key data";
static char (__pyx_k55[]) = "unable to allocate string";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_toDER_PublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_toDER_PublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_len;
  int __pyx_v_len1;
  PyObject (*__pyx_v_derStr);
  char (*__pyx_v_p);
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  int __pyx_4;
  PyObject *__pyx_5 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":465 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_hasPublicKey); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; goto __pyx_L1;}
  __pyx_2 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_3 = PyObject_IsTrue(__pyx_2); if (__pyx_3 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = (!__pyx_3);
  if (__pyx_4) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":466 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k53p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":467 */
  __pyx_v_len = i2d_RSAPublicKey(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa,0);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":468 */
  __pyx_3 = (__pyx_v_len < 0);
  if (__pyx_3) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":469 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k54p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":470 */
  __pyx_v_derStr = PyString_FromStringAndSize(0,__pyx_v_len);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":471 */
  __pyx_4 = (__pyx_v_derStr == 0);
  if (__pyx_4) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":472 */
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_MemoryError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k55p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; goto __pyx_L1;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":474 */
  __pyx_v_p = PyString_AsString(__pyx_v_derStr);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":475 */
  /*try:*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":476 */
    __pyx_v_len1 = i2d_RSAPublicKey(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa,((unsigned char (*(*)))(&__pyx_v_p)));

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":477 */
    if (!(__pyx_v_len == __pyx_v_len1)) {
      PyErr_SetNone(PyExc_AssertionError);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; goto __pyx_L6;}
    }

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":478 */
    __pyx_2 = (PyObject *)__pyx_v_derStr;
    Py_INCREF(__pyx_2);
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L5;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L7;
    __pyx_L5: __pyx_why = 3; goto __pyx_L7;
    __pyx_L6: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_1); __pyx_1 = 0;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      PyErr_Fetch(&__pyx_1, &__pyx_2, &__pyx_5);
      __pyx_3 = __pyx_lineno;
      goto __pyx_L7;
    }
    __pyx_L7:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":480 */
    Py_DECREF(__pyx_v_derStr);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_1, __pyx_2, __pyx_5);
        __pyx_lineno = __pyx_3;
        __pyx_1 = 0;
        __pyx_2 = 0;
        __pyx_5 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.toDER_PublicKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k56p;
static PyObject *__pyx_k57p;
static PyObject *__pyx_k58p;
static PyObject *__pyx_k59p;
static PyObject *__pyx_k60p;

static char (__pyx_k56[]) = "a string is expected";
static char (__pyx_k57[]) = "unable to allocate BIO structure";
static char (__pyx_k58[]) = "unable to write data to BIO";
static char (__pyx_k59[]) = "password is not a string";
static char (__pyx_k60[]) = "unable to load object from data";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_fromPEM_PrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_fromPEM_PrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_password = 0;
  char (*__pyx_v_p);
  int __pyx_v_dataLen;
  int __pyx_v_result;
  struct __pyx_t_10ncrypt_rsa_PemCbData __pyx_v_passwd_cb_data;
  BIO (*__pyx_v_b);
  RSA (*__pyx_v_newrsa);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"data","password",0};
  __pyx_v_password = __pyx_k8;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O|O", __pyx_argnames, &__pyx_v_data, &__pyx_v_password)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_data);
  Py_INCREF(__pyx_v_password);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":488 */
  __pyx_v_result = PyString_AsStringAndSize(__pyx_v_data,(&__pyx_v_p),(&__pyx_v_dataLen));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":489 */
  __pyx_1 = (__pyx_v_result < 0);
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":490 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k56p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":491 */
  __pyx_v_b = BIO_new(BIO_s_mem());

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":492 */
  __pyx_1 = (!(__pyx_v_b != 0));
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":493 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k57p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":494 */
  /*try:*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":495 */
    __pyx_v_result = BIO_write(__pyx_v_b,__pyx_v_p,__pyx_v_dataLen);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":496 */
    __pyx_1 = (__pyx_v_result < 0);
    if (__pyx_1) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":497 */
      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; goto __pyx_L5;}
      __Pyx_Raise(__pyx_2, __pyx_k58p, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; goto __pyx_L5;}
      goto __pyx_L7;
    }
    __pyx_L7:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":498 */
    __pyx_1 = __pyx_v_password == Py_None;
    if (__pyx_1) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":499 */
      __pyx_v_passwd_cb_data.data = 0;

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":500 */
      __pyx_v_passwd_cb_data.length = 0;
      goto __pyx_L8;
    }
    /*else*/ {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":502 */
      __pyx_v_result = PyString_AsStringAndSize(__pyx_v_password,(&__pyx_v_p),(&__pyx_v_dataLen));

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":503 */
      __pyx_1 = (__pyx_v_result < 0);
      if (__pyx_1) {

        /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":504 */
        __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; goto __pyx_L5;}
        __Pyx_Raise(__pyx_2, __pyx_k59p, 0);
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; goto __pyx_L5;}
        goto __pyx_L9;
      }
      /*else*/ {

        /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":506 */
        __pyx_v_passwd_cb_data.data = __pyx_v_p;

        /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":507 */
        __pyx_v_passwd_cb_data.length = __pyx_v_dataLen;
      }
      __pyx_L9:;
    }
    __pyx_L8:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":508 */
    __pyx_v_newrsa = PEM_read_bio_RSAPrivateKey(__pyx_v_b,0,(&__pyx_f_10ncrypt_rsa__password_callback),((void (*))(&__pyx_v_passwd_cb_data)));

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":509 */
    __pyx_1 = (!(__pyx_v_newrsa != 0));
    if (__pyx_1) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":510 */
      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 510; goto __pyx_L5;}
      __Pyx_Raise(__pyx_2, __pyx_k60p, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 510; goto __pyx_L5;}
      goto __pyx_L10;
    }
    __pyx_L10:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":511 */
    RSA_free(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":512 */
    ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa = __pyx_v_newrsa;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L6;
    __pyx_L5: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      PyErr_Fetch(&__pyx_2, &__pyx_3, &__pyx_4);
      __pyx_1 = __pyx_lineno;
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":514 */
    BIO_free(__pyx_v_b);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_2, __pyx_3, __pyx_4);
        __pyx_lineno = __pyx_1;
        __pyx_2 = 0;
        __pyx_3 = 0;
        __pyx_4 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.fromPEM_PrivateKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_data);
  Py_DECREF(__pyx_v_password);
  return __pyx_r;
}

static PyObject *__pyx_k61p;
static PyObject *__pyx_k62p;
static PyObject *__pyx_k63p;
static PyObject *__pyx_k64p;
static PyObject *__pyx_k65p;
static PyObject *__pyx_k66p;

static char (__pyx_k61[]) = "private key not initialized";
static char (__pyx_k62[]) = "unable to allocate a BIO structure";
static char (__pyx_k63[]) = "password is not a string";
static char (__pyx_k64[]) = "error allocating memory for password";
static char (__pyx_k65[]) = "error in public key data";
static char (__pyx_k66[]) = "error in creating PEM data";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_toPEM_PrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_toPEM_PrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_password = 0;
  char (*__pyx_v_p);
  char (*__pyx_v_q);
  int __pyx_v_dataLen;
  int __pyx_v_result;
  BIO (*__pyx_v_b);
  PyObject *__pyx_v_ret;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  int __pyx_4;
  PyObject *__pyx_5 = 0;
  static char *__pyx_argnames[] = {"password",0};
  __pyx_v_password = __pyx_k9;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "|O", __pyx_argnames, &__pyx_v_password)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_password);
  __pyx_v_ret = Py_None; Py_INCREF(Py_None);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":517 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_hasPrivateKey); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; goto __pyx_L1;}
  __pyx_2 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_3 = PyObject_IsTrue(__pyx_2); if (__pyx_3 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = (!__pyx_3);
  if (__pyx_4) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":518 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k61p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":522 */
  __pyx_v_b = BIO_new(BIO_s_mem());

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":523 */
  __pyx_3 = (!(__pyx_v_b != 0));
  if (__pyx_3) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":524 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k62p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":525 */
  /*try:*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":526 */
    __pyx_4 = __pyx_v_password == Py_None;
    if (__pyx_4) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":527 */
      __pyx_v_result = PEM_write_bio_RSAPrivateKey(__pyx_v_b,((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa,0,0,0,0,0);
      goto __pyx_L7;
    }
    /*else*/ {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":530 */
      __pyx_v_result = PyString_AsStringAndSize(__pyx_v_password,(&__pyx_v_p),(&__pyx_v_dataLen));

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":531 */
      __pyx_3 = (__pyx_v_result < 0);
      if (__pyx_3) {

        /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":532 */
        __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; goto __pyx_L5;}
        __Pyx_Raise(__pyx_1, __pyx_k63p, 0);
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; goto __pyx_L5;}
        goto __pyx_L8;
      }
      __pyx_L8:;

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":533 */
      __pyx_v_q = ((char (*))malloc(__pyx_v_dataLen));

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":534 */
      __pyx_4 = (__pyx_v_q == 0);
      if (__pyx_4) {

        /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":535 */
        __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_MemoryError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; goto __pyx_L5;}
        __Pyx_Raise(__pyx_2, __pyx_k64p, 0);
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; goto __pyx_L5;}
        goto __pyx_L9;
      }
      __pyx_L9:;

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":536 */
      memcpy(__pyx_v_q,__pyx_v_p,__pyx_v_dataLen);

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":537 */
      /*try:*/ {

        /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":538 */
        __pyx_v_result = PEM_write_bio_RSAPrivateKey(__pyx_v_b,((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa,EVP_des_ede3_cbc(),__pyx_v_p,__pyx_v_dataLen,0,0);
      }
      /*finally:*/ {
        int __pyx_why;
        __pyx_why = 0; goto __pyx_L12;
        __pyx_L12:;

        /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":541 */
        free(__pyx_v_q);
        switch (__pyx_why) {
          case 3: goto __pyx_L4;
          case 4: {
            PyErr_Restore(__pyx_1, __pyx_2, __pyx_5);
            __pyx_lineno = __pyx_3;
            __pyx_1 = 0;
            __pyx_2 = 0;
            __pyx_5 = 0;
            goto __pyx_L5;
          }
        }
      }
    }
    __pyx_L7:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":542 */
    __pyx_4 = (!__pyx_v_result);
    if (__pyx_4) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":543 */
      __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; goto __pyx_L5;}
      __Pyx_Raise(__pyx_1, __pyx_k65p, 0);
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; goto __pyx_L5;}
      goto __pyx_L13;
    }
    __pyx_L13:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":544 */
    __pyx_2 = GetBIOData(__pyx_v_b); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L5;}
    Py_DECREF(__pyx_v_ret);
    __pyx_v_ret = __pyx_2;
    __pyx_2 = 0;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":545 */
    __pyx_4 = __pyx_v_ret == Py_None;
    if (__pyx_4) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":546 */
      __pyx_5 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; goto __pyx_L5;}
      __Pyx_Raise(__pyx_5, __pyx_k66p, 0);
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; goto __pyx_L5;}
      goto __pyx_L14;
    }
    __pyx_L14:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":547 */
    Py_INCREF(__pyx_v_ret);
    __pyx_r = __pyx_v_ret;
    goto __pyx_L4;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L6;
    __pyx_L4: __pyx_why = 3; goto __pyx_L6;
    __pyx_L5: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_1); __pyx_1 = 0;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      Py_XDECREF(__pyx_5); __pyx_5 = 0;
      PyErr_Fetch(&__pyx_1, &__pyx_2, &__pyx_5);
      __pyx_4 = __pyx_lineno;
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":549 */
    BIO_free(__pyx_v_b);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_1, __pyx_2, __pyx_5);
        __pyx_lineno = __pyx_4;
        __pyx_1 = 0;
        __pyx_2 = 0;
        __pyx_5 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.toPEM_PrivateKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_ret);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_password);
  return __pyx_r;
}

static PyObject *__pyx_k67p;
static PyObject *__pyx_k68p;
static PyObject *__pyx_k69p;
static PyObject *__pyx_k70p;

static char (__pyx_k67[]) = "a string is expected";
static char (__pyx_k68[]) = "unable to allocate BIO structure";
static char (__pyx_k69[]) = "unable to write data to BIO";
static char (__pyx_k70[]) = "unable to load object from data";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_fromPEM_PublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_fromPEM_PublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_data = 0;
  char (*__pyx_v_p);
  int __pyx_v_dataLen;
  int __pyx_v_result;
  BIO (*__pyx_v_b);
  RSA (*__pyx_v_newrsa);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"data",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_data)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_data);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":556 */
  __pyx_v_result = PyString_AsStringAndSize(__pyx_v_data,(&__pyx_v_p),(&__pyx_v_dataLen));

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":557 */
  __pyx_1 = (__pyx_v_result < 0);
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":558 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 558; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k67p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 558; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":559 */
  __pyx_v_b = BIO_new(BIO_s_mem());

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":560 */
  __pyx_1 = (!(__pyx_v_b != 0));
  if (__pyx_1) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":561 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k68p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":562 */
  /*try:*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":563 */
    __pyx_v_result = BIO_write(__pyx_v_b,__pyx_v_p,__pyx_v_dataLen);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":564 */
    __pyx_1 = (__pyx_v_result < 0);
    if (__pyx_1) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":565 */
      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; goto __pyx_L5;}
      __Pyx_Raise(__pyx_2, __pyx_k69p, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; goto __pyx_L5;}
      goto __pyx_L7;
    }
    __pyx_L7:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":566 */
    __pyx_v_newrsa = PEM_read_bio_RSAPublicKey(__pyx_v_b,0,0,0);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":567 */
    __pyx_1 = (!(__pyx_v_newrsa != 0));
    if (__pyx_1) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":568 */
      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; goto __pyx_L5;}
      __Pyx_Raise(__pyx_2, __pyx_k70p, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; goto __pyx_L5;}
      goto __pyx_L8;
    }
    __pyx_L8:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":569 */
    RSA_free(((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":570 */
    ((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa = __pyx_v_newrsa;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L6;
    __pyx_L5: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      PyErr_Fetch(&__pyx_2, &__pyx_3, &__pyx_4);
      __pyx_1 = __pyx_lineno;
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":572 */
    BIO_free(__pyx_v_b);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_2, __pyx_3, __pyx_4);
        __pyx_lineno = __pyx_1;
        __pyx_2 = 0;
        __pyx_3 = 0;
        __pyx_4 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.fromPEM_PublicKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_data);
  return __pyx_r;
}

static PyObject *__pyx_k71p;
static PyObject *__pyx_k72p;
static PyObject *__pyx_k73p;
static PyObject *__pyx_k74p;

static char (__pyx_k71[]) = "public key not initialized";
static char (__pyx_k72[]) = "unable to allocate a BIO structure";
static char (__pyx_k73[]) = "error in public key data";
static char (__pyx_k74[]) = "error in creating PEM data";

static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_toPEM_PublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_rsa_6RSAKey_toPEM_PublicKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_result;
  BIO (*__pyx_v_b);
  PyObject *__pyx_v_ret;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  int __pyx_4;
  PyObject *__pyx_5 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);
  __pyx_v_ret = Py_None; Py_INCREF(Py_None);

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":575 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_hasPublicKey); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 575; goto __pyx_L1;}
  __pyx_2 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 575; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_3 = PyObject_IsTrue(__pyx_2); if (__pyx_3 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 575; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = (!__pyx_3);
  if (__pyx_4) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":576 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 576; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k71p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 576; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":579 */
  __pyx_v_b = BIO_new(BIO_s_mem());

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":580 */
  __pyx_3 = (!(__pyx_v_b != 0));
  if (__pyx_3) {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":581 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 581; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k72p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 581; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":582 */
  /*try:*/ {

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":583 */
    __pyx_v_result = PEM_write_bio_RSAPublicKey(__pyx_v_b,((struct __pyx_obj_10ncrypt_rsa_RSAKey *)__pyx_v_self)->rsa);

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":584 */
    __pyx_4 = (!__pyx_v_result);
    if (__pyx_4) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":585 */
      __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; goto __pyx_L5;}
      __Pyx_Raise(__pyx_1, __pyx_k73p, 0);
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; goto __pyx_L5;}
      goto __pyx_L7;
    }
    __pyx_L7:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":586 */
    __pyx_2 = GetBIOData(__pyx_v_b); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; goto __pyx_L5;}
    Py_DECREF(__pyx_v_ret);
    __pyx_v_ret = __pyx_2;
    __pyx_2 = 0;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":587 */
    __pyx_3 = __pyx_v_ret == Py_None;
    if (__pyx_3) {

      /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":588 */
      __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RSAError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; goto __pyx_L5;}
      __Pyx_Raise(__pyx_1, __pyx_k74p, 0);
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; goto __pyx_L5;}
      goto __pyx_L8;
    }
    __pyx_L8:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":589 */
    Py_INCREF(__pyx_v_ret);
    __pyx_r = __pyx_v_ret;
    goto __pyx_L4;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L6;
    __pyx_L4: __pyx_why = 3; goto __pyx_L6;
    __pyx_L5: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      Py_XDECREF(__pyx_1); __pyx_1 = 0;
      PyErr_Fetch(&__pyx_2, &__pyx_1, &__pyx_5);
      __pyx_4 = __pyx_lineno;
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":591 */
    BIO_free(__pyx_v_b);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_2, __pyx_1, __pyx_5);
        __pyx_lineno = __pyx_4;
        __pyx_2 = 0;
        __pyx_1 = 0;
        __pyx_5 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("ncrypt_rsa.RSAKey.toPEM_PublicKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_ret);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static __Pyx_InternTabEntry __pyx_intern_tab[] = {
  {&__pyx_n_BaseLibraryError, "BaseLibraryError"},
  {&__pyx_n_False, "False"},
  {&__pyx_n_MemoryError, "MemoryError"},
  {&__pyx_n_PADDING_PKCS1, "PADDING_PKCS1"},
  {&__pyx_n_PADDING_PKCS1_OAEP, "PADDING_PKCS1_OAEP"},
  {&__pyx_n_RSAError, "RSAError"},
  {&__pyx_n_True, "True"},
  {&__pyx_n_TypeError, "TypeError"},
  {&__pyx_n_callback, "callback"},
  {&__pyx_n_e, "e"},
  {&__pyx_n_get, "get"},
  {&__pyx_n_hasPrivateKey, "hasPrivateKey"},
  {&__pyx_n_hasPublicKey, "hasPublicKey"},
  {&__pyx_n_len, "len"},
  {&__pyx_n_maxInputSize, "maxInputSize"},
  {&__pyx_n_ncrypt_err, "ncrypt_err"},
  {&__pyx_n_nid, "nid"},
  {&__pyx_n_paddingSize, "paddingSize"},
  {&__pyx_n_size, "size"},
  {0, 0}
};

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_k12p, __pyx_k12, sizeof(__pyx_k12)},
  {&__pyx_k13p, __pyx_k13, sizeof(__pyx_k13)},
  {&__pyx_k14p, __pyx_k14, sizeof(__pyx_k14)},
  {&__pyx_k15p, __pyx_k15, sizeof(__pyx_k15)},
  {&__pyx_k16p, __pyx_k16, sizeof(__pyx_k16)},
  {&__pyx_k17p, __pyx_k17, sizeof(__pyx_k17)},
  {&__pyx_k18p, __pyx_k18, sizeof(__pyx_k18)},
  {&__pyx_k19p, __pyx_k19, sizeof(__pyx_k19)},
  {&__pyx_k20p, __pyx_k20, sizeof(__pyx_k20)},
  {&__pyx_k21p, __pyx_k21, sizeof(__pyx_k21)},
  {&__pyx_k22p, __pyx_k22, sizeof(__pyx_k22)},
  {&__pyx_k23p, __pyx_k23, sizeof(__pyx_k23)},
  {&__pyx_k24p, __pyx_k24, sizeof(__pyx_k24)},
  {&__pyx_k25p, __pyx_k25, sizeof(__pyx_k25)},
  {&__pyx_k26p, __pyx_k26, sizeof(__pyx_k26)},
  {&__pyx_k27p, __pyx_k27, sizeof(__pyx_k27)},
  {&__pyx_k28p, __pyx_k28, sizeof(__pyx_k28)},
  {&__pyx_k29p, __pyx_k29, sizeof(__pyx_k29)},
  {&__pyx_k30p, __pyx_k30, sizeof(__pyx_k30)},
  {&__pyx_k31p, __pyx_k31, sizeof(__pyx_k31)},
  {&__pyx_k32p, __pyx_k32, sizeof(__pyx_k32)},
  {&__pyx_k33p, __pyx_k33, sizeof(__pyx_k33)},
  {&__pyx_k34p, __pyx_k34, sizeof(__pyx_k34)},
  {&__pyx_k35p, __pyx_k35, sizeof(__pyx_k35)},
  {&__pyx_k36p, __pyx_k36, sizeof(__pyx_k36)},
  {&__pyx_k37p, __pyx_k37, sizeof(__pyx_k37)},
  {&__pyx_k38p, __pyx_k38, sizeof(__pyx_k38)},
  {&__pyx_k39p, __pyx_k39, sizeof(__pyx_k39)},
  {&__pyx_k40p, __pyx_k40, sizeof(__pyx_k40)},
  {&__pyx_k41p, __pyx_k41, sizeof(__pyx_k41)},
  {&__pyx_k42p, __pyx_k42, sizeof(__pyx_k42)},
  {&__pyx_k43p, __pyx_k43, sizeof(__pyx_k43)},
  {&__pyx_k44p, __pyx_k44, sizeof(__pyx_k44)},
  {&__pyx_k45p, __pyx_k45, sizeof(__pyx_k45)},
  {&__pyx_k46p, __pyx_k46, sizeof(__pyx_k46)},
  {&__pyx_k47p, __pyx_k47, sizeof(__pyx_k47)},
  {&__pyx_k48p, __pyx_k48, sizeof(__pyx_k48)},
  {&__pyx_k49p, __pyx_k49, sizeof(__pyx_k49)},
  {&__pyx_k50p, __pyx_k50, sizeof(__pyx_k50)},
  {&__pyx_k51p, __pyx_k51, sizeof(__pyx_k51)},
  {&__pyx_k52p, __pyx_k52, sizeof(__pyx_k52)},
  {&__pyx_k53p, __pyx_k53, sizeof(__pyx_k53)},
  {&__pyx_k54p, __pyx_k54, sizeof(__pyx_k54)},
  {&__pyx_k55p, __pyx_k55, sizeof(__pyx_k55)},
  {&__pyx_k56p, __pyx_k56, sizeof(__pyx_k56)},
  {&__pyx_k57p, __pyx_k57, sizeof(__pyx_k57)},
  {&__pyx_k58p, __pyx_k58, sizeof(__pyx_k58)},
  {&__pyx_k59p, __pyx_k59, sizeof(__pyx_k59)},
  {&__pyx_k60p, __pyx_k60, sizeof(__pyx_k60)},
  {&__pyx_k61p, __pyx_k61, sizeof(__pyx_k61)},
  {&__pyx_k62p, __pyx_k62, sizeof(__pyx_k62)},
  {&__pyx_k63p, __pyx_k63, sizeof(__pyx_k63)},
  {&__pyx_k64p, __pyx_k64, sizeof(__pyx_k64)},
  {&__pyx_k65p, __pyx_k65, sizeof(__pyx_k65)},
  {&__pyx_k66p, __pyx_k66, sizeof(__pyx_k66)},
  {&__pyx_k67p, __pyx_k67, sizeof(__pyx_k67)},
  {&__pyx_k68p, __pyx_k68, sizeof(__pyx_k68)},
  {&__pyx_k69p, __pyx_k69, sizeof(__pyx_k69)},
  {&__pyx_k70p, __pyx_k70, sizeof(__pyx_k70)},
  {&__pyx_k71p, __pyx_k71, sizeof(__pyx_k71)},
  {&__pyx_k72p, __pyx_k72, sizeof(__pyx_k72)},
  {&__pyx_k73p, __pyx_k73, sizeof(__pyx_k73)},
  {&__pyx_k74p, __pyx_k74, sizeof(__pyx_k74)},
  {0, 0, 0}
};
static struct __pyx_vtabstruct_10ncrypt_rsa_RSAKey __pyx_vtable_10ncrypt_rsa_RSAKey;

static PyObject *__pyx_tp_new_10ncrypt_rsa_RSAKey(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  struct __pyx_obj_10ncrypt_rsa_RSAKey *p = (struct __pyx_obj_10ncrypt_rsa_RSAKey *)o;
  *(struct __pyx_vtabstruct_10ncrypt_rsa_RSAKey **)&p->__pyx_vtab = __pyx_vtabptr_10ncrypt_rsa_RSAKey;
  if (__pyx_f_10ncrypt_rsa_6RSAKey___new__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_10ncrypt_rsa_RSAKey(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++o->ob_refcnt;
    __pyx_f_10ncrypt_rsa_6RSAKey___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --o->ob_refcnt;
    PyErr_Restore(etype, eval, etb);
  }
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_10ncrypt_rsa_RSAKey(PyObject *o, visitproc v, void *a) {
  return 0;
}

static int __pyx_tp_clear_10ncrypt_rsa_RSAKey(PyObject *o) {
  return 0;
}

static struct PyMethodDef __pyx_methods_10ncrypt_rsa_RSAKey[] = {
  {"generate", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_generate, METH_VARARGS|METH_KEYWORDS, 0},
  {"size", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_size, METH_VARARGS|METH_KEYWORDS, 0},
  {"check", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_check, METH_VARARGS|METH_KEYWORDS, 0},
  {"enableBlinding", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_enableBlinding, METH_VARARGS|METH_KEYWORDS, 0},
  {"getN", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_getN, METH_VARARGS|METH_KEYWORDS, 0},
  {"getE", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_getE, METH_VARARGS|METH_KEYWORDS, 0},
  {"getD", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_getD, METH_VARARGS|METH_KEYWORDS, 0},
  {"getP", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_getP, METH_VARARGS|METH_KEYWORDS, 0},
  {"getQ", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_getQ, METH_VARARGS|METH_KEYWORDS, 0},
  {"hasPublicKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_hasPublicKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"hasPrivateKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_hasPrivateKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"getPublicKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_getPublicKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"getPrivateKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_getPrivateKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"loadPublicKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_loadPublicKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"loadPrivateKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_loadPrivateKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"paddingSize", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_paddingSize, METH_VARARGS|METH_KEYWORDS, 0},
  {"maxInputSize", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_maxInputSize, METH_VARARGS|METH_KEYWORDS, 0},
  {"encrypt", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_encrypt, METH_VARARGS|METH_KEYWORDS, 0},
  {"decrypt", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_decrypt, METH_VARARGS|METH_KEYWORDS, 0},
  {"sign", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_sign, METH_VARARGS|METH_KEYWORDS, 0},
  {"verify", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_verify, METH_VARARGS|METH_KEYWORDS, 0},
  {"fromDER_PrivateKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_fromDER_PrivateKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"toDER_PrivateKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_toDER_PrivateKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"fromDER_PublicKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_fromDER_PublicKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"toDER_PublicKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_toDER_PublicKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"fromPEM_PrivateKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_fromPEM_PrivateKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"toPEM_PrivateKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_toPEM_PrivateKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"fromPEM_PublicKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_fromPEM_PublicKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"toPEM_PublicKey", (PyCFunction)__pyx_f_10ncrypt_rsa_6RSAKey_toPEM_PublicKey, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_RSAKey = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
};

static PySequenceMethods __pyx_tp_as_sequence_RSAKey = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_RSAKey = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_RSAKey = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_10ncrypt_rsa_RSAKey = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "ncrypt_rsa.RSAKey", /*tp_name*/
  sizeof(struct __pyx_obj_10ncrypt_rsa_RSAKey), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_10ncrypt_rsa_RSAKey, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_RSAKey, /*tp_as_number*/
  &__pyx_tp_as_sequence_RSAKey, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_RSAKey, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_RSAKey, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_10ncrypt_rsa_RSAKey, /*tp_traverse*/
  __pyx_tp_clear_10ncrypt_rsa_RSAKey, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_10ncrypt_rsa_RSAKey, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_10ncrypt_rsa_6RSAKey___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_10ncrypt_rsa_RSAKey, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static struct PyMethodDef __pyx_methods[] = {
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

PyMODINIT_FUNC initncrypt_rsa(void); /*proto*/
PyMODINIT_FUNC initncrypt_rsa(void) {
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  __pyx_init_filenames();
  __pyx_m = Py_InitModule4("ncrypt_rsa", __pyx_methods, 0, 0, PYTHON_API_VERSION);
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  __pyx_b = PyImport_AddModule("__builtin__");
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  if (__Pyx_InternStrings(__pyx_intern_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  __pyx_vtabptr_10ncrypt_rsa_RSAKey = &__pyx_vtable_10ncrypt_rsa_RSAKey;
  *(void(**)())&__pyx_vtable_10ncrypt_rsa_RSAKey.loadCPublicKey = (void(*)())__pyx_f_10ncrypt_rsa_6RSAKey_loadCPublicKey;
  *(void(**)())&__pyx_vtable_10ncrypt_rsa_RSAKey.loadCPrivateKey = (void(*)())__pyx_f_10ncrypt_rsa_6RSAKey_loadCPrivateKey;
  if (PyType_Ready(&__pyx_type_10ncrypt_rsa_RSAKey) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; goto __pyx_L1;}
  if (__Pyx_SetVtable(__pyx_type_10ncrypt_rsa_RSAKey.tp_dict, __pyx_vtabptr_10ncrypt_rsa_RSAKey) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "RSAKey", (PyObject *)&__pyx_type_10ncrypt_rsa_RSAKey) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; goto __pyx_L1;}
  __pyx_ptype_10ncrypt_rsa_RSAKey = &__pyx_type_10ncrypt_rsa_RSAKey;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":88 */
  __pyx_1 = __Pyx_Import(__pyx_n_ncrypt_err, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_ncrypt_err, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":110 */
  __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_ncrypt_err); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; goto __pyx_L1;}
  __pyx_3 = PyObject_GetAttr(__pyx_2, __pyx_n_BaseLibraryError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = __Pyx_CreateClass(__pyx_2, __pyx_1, __pyx_n_RSAError, "ncrypt_rsa"); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_RSAError, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":116 */
  __pyx_2 = PyInt_FromLong(0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_PADDING_PKCS1, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":117 */
  __pyx_3 = PyInt_FromLong(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_PADDING_PKCS1_OAEP, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":141 */
  __pyx_1 = PyInt_FromLong(1024); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; goto __pyx_L1;}
  __pyx_k3 = __pyx_1;
  __pyx_1 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":170 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_True); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
  __pyx_k4 = __pyx_2;
  __pyx_2 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":273 */
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_PADDING_PKCS1_OAEP); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; goto __pyx_L1;}
  __pyx_k5 = __pyx_3;
  __pyx_3 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":276 */
  __pyx_4 = __Pyx_GetName(__pyx_m, __pyx_n_PADDING_PKCS1_OAEP); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; goto __pyx_L1;}
  __pyx_k6 = __pyx_4;
  __pyx_4 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":317 */
  __pyx_5 = __Pyx_GetName(__pyx_m, __pyx_n_PADDING_PKCS1_OAEP); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; goto __pyx_L1;}
  __pyx_k7 = __pyx_5;
  __pyx_5 = 0;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":482 */
  Py_INCREF(Py_None);
  __pyx_k8 = Py_None;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":516 */
  Py_INCREF(Py_None);
  __pyx_k9 = Py_None;

  /* "/home/ivan/Super-Adventure-Club/ncrypt-0.6.4/ncrypt_rsa.pyx":574 */
  return;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("ncrypt_rsa");
}

static char *__pyx_filenames[] = {
  "ncrypt_rsa.pyx",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static int __Pyx_GetStarArgs(
    PyObject **args, 
    PyObject **kwds,
    char *kwd_list[], 
    int nargs,
    PyObject **args2, 
    PyObject **kwds2)
{
    PyObject *x = 0, *args1 = 0, *kwds1 = 0;
    
    if (args2)
        *args2 = 0;
    if (kwds2)
        *kwds2 = 0;
    
    if (args2) {
        args1 = PyTuple_GetSlice(*args, 0, nargs);
        if (!args1)
            goto bad;
        *args2 = PyTuple_GetSlice(*args, nargs, PyTuple_Size(*args));
        if (!*args2)
            goto bad;
    }
    else {
        args1 = *args;
        Py_INCREF(args1);
    }
    
    if (kwds2) {
        if (*kwds) {
            char **p;
            kwds1 = PyDict_New();
            if (!kwds)
                goto bad;
            *kwds2 = PyDict_Copy(*kwds);
            if (!*kwds2)
                goto bad;
            for (p = kwd_list; *p; p++) {
                x = PyDict_GetItemString(*kwds, *p);
                if (x) {
                    if (PyDict_SetItemString(kwds1, *p, x) < 0)
                        goto bad;
                    if (PyDict_DelItemString(*kwds2, *p) < 0)
                        goto bad;
                }
            }
        }
        else {
            *kwds2 = PyDict_New();
            if (!*kwds2)
                goto bad;
        }
    }
    else {
        kwds1 = *kwds;
        Py_XINCREF(kwds1);
    }
    
    *args = args1;
    *kwds = kwds1;
    return 0;
bad:
    Py_XDECREF(args1);
    Py_XDECREF(kwds1);
    if (*args2) {
        Py_XDECREF(*args2);
    }
    if (*kwds2) {
        Py_XDECREF(*kwds2);
    }
    return -1;
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
    PyObject *__import__ = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    __import__ = PyObject_GetAttrString(__pyx_b, "__import__");
    if (!__import__)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    module = PyObject_CallFunction(__import__, "OOOO",
        name, global_dict, empty_dict, list);
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(__import__);
    Py_XDECREF(empty_dict);
    return module;
}

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result)
        PyErr_SetObject(PyExc_NameError, name);
    return result;
}

static PyObject *__Pyx_CreateClass(
    PyObject *bases, PyObject *dict, PyObject *name, char *modname)
{
    PyObject *py_modname;
    PyObject *result = 0;
    
    py_modname = PyString_FromString(modname);
    if (!py_modname)
        goto bad;
    if (PyDict_SetItemString(dict, "__module__", py_modname) < 0)
        goto bad;
    result = PyClass_New(bases, dict, name);
bad:
    Py_XDECREF(py_modname);
    return result;
}

static void __Pyx_WriteUnraisable(char *name) {
    PyObject *old_exc, *old_val, *old_tb;
    PyObject *ctx;
    PyErr_Fetch(&old_exc, &old_val, &old_tb);
    ctx = PyString_FromString(name);
    PyErr_Restore(old_exc, old_val, old_tb);
    if (!ctx)
        ctx = Py_None;
    PyErr_WriteUnraisable(ctx);
}

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    /* Next, repeatedly, replace a tuple exception with its first item */
    while (PyTuple_Check(type) && PyTuple_Size(type) > 0) {
        PyObject *tmp = type;
        type = PyTuple_GET_ITEM(type, 0);
        Py_INCREF(type);
        Py_DECREF(tmp);
    }
    if (PyString_Check(type)) {
        if (PyErr_Warn(PyExc_DeprecationWarning,
                "raising a string exception is deprecated"))
            goto raise_error;
    }
    else if (PyType_Check(type) || PyClass_Check(type))
        ; /*PyErr_NormalizeException(&type, &value, &tb);*/
    else {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        if (PyInstance_Check(type))
            type = (PyObject*) ((PyInstanceObject*)type)->in_class;
        else
            type = (PyObject*) type->ob_type;
        Py_INCREF(type);
    }
    PyErr_Restore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

static void __Pyx_UnpackError(void) {
    PyErr_SetString(PyExc_ValueError, "unpack sequence of wrong size");
}

static PyObject *__Pyx_UnpackItem(PyObject *iter) {
    PyObject *item;
    if (!(item = PyIter_Next(iter))) {
        if (!PyErr_Occurred())
            __Pyx_UnpackError();
    }
    return item;
}

static int __Pyx_EndUnpack(PyObject *iter) {
    PyObject *item;
    if ((item = PyIter_Next(iter))) {
        Py_DECREF(item);
        __Pyx_UnpackError();
        return -1;
    }
    else if (!PyErr_Occurred())
        return 0;
    else
        return -1;
}

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t) {
    while (t->p) {
        *t->p = PyString_InternFromString(t->s);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
    PyObject *pycobj = 0;
    int result;
    
    pycobj = PyCObject_FromVoidPtr(vtable, 0);
    if (!pycobj)
        goto bad;
    if (PyDict_SetItemString(dict, "__pyx_vtable__", pycobj) < 0)
        goto bad;
    result = 0;
    goto done;

bad:
    result = -1;
done:
    Py_XDECREF(pycobj);
    return result;
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_tuple = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    
    py_srcfile = PyString_FromString(__pyx_filename);
    if (!py_srcfile) goto bad;
    py_funcname = PyString_FromString(funcname);
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    empty_tuple = PyTuple_New(0);
    if (!empty_tuple) goto bad;
    empty_string = PyString_FromString("");
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        empty_tuple,  /*PyObject *consts,*/
        empty_tuple,  /*PyObject *names,*/
        empty_tuple,  /*PyObject *varnames,*/
        empty_tuple,  /*PyObject *freevars,*/
        empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_Get(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_tuple);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}
