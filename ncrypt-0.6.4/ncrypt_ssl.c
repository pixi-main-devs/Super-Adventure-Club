/* Generated by Pyrex 0.9.5 on Wed May 18 01:59:47 2011 */

#include "Python.h"
#include "structmember.h"
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
__PYX_EXTERN_C double pow(double, double);
#include "openssl/rsa.h"
#include "openssl/x509.h"
#include "openssl/ssl.h"
#include "openssl/err.h"
#include "openssl/dh.h"


typedef struct {PyObject **p; char *s;} __Pyx_InternTabEntry; /*proto*/
typedef struct {PyObject **p; char *s; long n;} __Pyx_StringTabEntry; /*proto*/

static PyObject *__pyx_m;
static PyObject *__pyx_b;
static int __pyx_lineno;
static char *__pyx_filename;
static char **__pyx_f;

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed, char *name); /*proto*/

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static PyObject *__Pyx_CreateClass(PyObject *bases, PyObject *dict, PyObject *name, char *modname); /*proto*/

static int __Pyx_GetStarArgs(PyObject **args, PyObject **kwds, char *kwd_list[], int nargs, PyObject **args2, PyObject **kwds2); /*proto*/

static void __Pyx_WriteUnraisable(char *name); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type); /*proto*/

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

static int __Pyx_SetVtable(PyObject *dict, void *vtable); /*proto*/

static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, long size);  /*proto*/

static int __Pyx_GetVtable(PyObject *dict, void *vtabptr); /*proto*/

static void __Pyx_AddTraceback(char *funcname); /*proto*/

/* Declarations from ncrypt_x509 */


struct __pyx_obj_11ncrypt_x509_X509Certificate {
  PyObject_HEAD
  struct __pyx_vtabstruct_11ncrypt_x509_X509Certificate *__pyx_vtab;
  X509 (*x);
};

struct __pyx_vtabstruct_11ncrypt_x509_X509Certificate {
  int ((*fromX509)(struct __pyx_obj_11ncrypt_x509_X509Certificate *,X509 (*)));
};
static struct __pyx_vtabstruct_11ncrypt_x509_X509Certificate *__pyx_vtabptr_11ncrypt_x509_X509Certificate;

static PyTypeObject *__pyx_ptype_11ncrypt_x509_X509Certificate = 0;

/* Declarations from ncrypt_dh */


struct __pyx_obj_9ncrypt_dh_DH {
  PyObject_HEAD
  DH (*dh);
};

static PyTypeObject *__pyx_ptype_9ncrypt_dh_DH = 0;

/* Declarations from ncrypt_rsa */


struct __pyx_obj_10ncrypt_rsa_RSAKey {
  PyObject_HEAD
  struct __pyx_vtabstruct_10ncrypt_rsa_RSAKey *__pyx_vtab;
  RSA (*rsa);
};

struct __pyx_vtabstruct_10ncrypt_rsa_RSAKey {
  void ((*loadCPublicKey)(struct __pyx_obj_10ncrypt_rsa_RSAKey *,RSA (*)));
  void ((*loadCPrivateKey)(struct __pyx_obj_10ncrypt_rsa_RSAKey *,RSA (*)));
};
static struct __pyx_vtabstruct_10ncrypt_rsa_RSAKey *__pyx_vtabptr_10ncrypt_rsa_RSAKey;

static PyTypeObject *__pyx_ptype_10ncrypt_rsa_RSAKey = 0;

/* Declarations from ncrypt_ssl */


struct __pyx_obj_10ncrypt_ssl_SSLContext {
  PyObject_HEAD
  SSL_CTX (*c);
};


struct __pyx_obj_10ncrypt_ssl_SSLConnection {
  PyObject_HEAD
  struct __pyx_vtabstruct_10ncrypt_ssl_SSLConnection *__pyx_vtab;
  SSL (*s);
  PyObject *sslContext;
  PyObject *sock;
};

struct __pyx_vtabstruct_10ncrypt_ssl_SSLConnection {
  PyObject *((*getSSLError)(struct __pyx_obj_10ncrypt_ssl_SSLConnection *,int ));
};
static struct __pyx_vtabstruct_10ncrypt_ssl_SSLConnection *__pyx_vtabptr_10ncrypt_ssl_SSLConnection;

static PyTypeObject *__pyx_ptype_10ncrypt_ssl_SSLContext = 0;
static PyTypeObject *__pyx_ptype_10ncrypt_ssl_SSLConnection = 0;
static PyObject *__pyx_k13;
static int __pyx_k14;
static SSL_METHOD (*(__pyx_f_10ncrypt_ssl_getSSLMethod(int ,int ))); /*proto*/
static int (__pyx_f_10ncrypt_ssl_SelfSignedVerifyCallback(int ,X509_STORE_CTX (*))); /*proto*/


/* Implementation of ncrypt_ssl */


static PyObject *__pyx_n_ncrypt_x509;
static PyObject *__pyx_n_ncrypt_dh;
static PyObject *__pyx_n_ncrypt_rsa;
static PyObject *__pyx_n_ncrypt_err;
static PyObject *__pyx_n_SSL_METHOD_SSLv2;
static PyObject *__pyx_n_SSL_METHOD_SSLv3;
static PyObject *__pyx_n_SSL_METHOD_TLSv1;
static PyObject *__pyx_n_SSL_METHOD_SSLv23;
static PyObject *__pyx_n_SSL_METHOD_MAX;
static PyObject *__pyx_n_SSL_METHOD_TYPE_CLIENT;
static PyObject *__pyx_n_SSL_METHOD_TYPE_SERVER;
static PyObject *__pyx_n_SSL_METHOD_TYPE_GENERIC;
static PyObject *__pyx_n_SSL_METHOD_TYPE_MAX;
static PyObject *__pyx_n_SSLError;
static PyObject *__pyx_n_SSLCertificateError;
static PyObject *__pyx_n_SSLWantError;
static PyObject *__pyx_n_SSLWantReadError;
static PyObject *__pyx_n_SSLWantWriteError;
static PyObject *__pyx_n_SSLWantX509LookupError;
static PyObject *__pyx_n_SSLZeroReturnError;
static PyObject *__pyx_n_SSLLibraryError;
static PyObject *__pyx_n_SSLSysCallError;
static PyObject *__pyx_n_SSLProtocolError;
static PyObject *__pyx_n_SSL_VERIFY_MODE_NONE;
static PyObject *__pyx_n_SSL_VERIFY_MODE_SELF_SIGNED;
static PyObject *__pyx_n_SSL_VERIFY_MODE_MAX;
static PyObject *__pyx_n_BaseError;
static PyObject *__pyx_n_LibraryErrorInfo;
static PyObject *__pyx_n___init__;

static PyObject *__pyx_n_initErrorInfo;
static PyObject *__pyx_n_updateArgs;

static PyObject *__pyx_f_10ncrypt_ssl_15SSLLibraryError___init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10ncrypt_ssl_15SSLLibraryError___init__ = {"__init__", (PyCFunction)__pyx_f_10ncrypt_ssl_15SSLLibraryError___init__, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_f_10ncrypt_ssl_15SSLLibraryError___init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"self",0};
  if (__Pyx_GetStarArgs(&__pyx_args, &__pyx_kwds, __pyx_argnames, 1, &__pyx_v_args, 0) < 0) return 0;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_self)) {
    Py_XDECREF(__pyx_args);
    Py_XDECREF(__pyx_kwds);
    Py_XDECREF(__pyx_v_args);
    return 0;
  }
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":121 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_ncrypt_err); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_LibraryErrorInfo); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_initErrorInfo); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_self);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":122 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_updateArgs); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; goto __pyx_L1;}
  Py_INCREF(__pyx_v_args);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_args);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_v_args);
  __pyx_v_args = __pyx_3;
  __pyx_3 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":123 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSLError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n___init__); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self);
  __pyx_1 = PySequence_Tuple(__pyx_v_args); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; goto __pyx_L1;}
  __pyx_4 = PyNumber_Add(__pyx_3, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_ssl.SSLLibraryError.__init__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_XDECREF(__pyx_v_args);
  Py_DECREF(__pyx_v_self);
  Py_XDECREF(__pyx_args);
  Py_XDECREF(__pyx_kwds);
  return __pyx_r;
}

static SSL_METHOD (*__pyx_f_10ncrypt_ssl_getSSLMethod(int __pyx_v_method,int __pyx_v_methodType)) {
  PyObject *__pyx_v_m;
  PyObject *__pyx_v_t;
  SSL_METHOD (*__pyx_r);
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  __pyx_v_m = Py_None; Py_INCREF(Py_None);
  __pyx_v_t = Py_None; Py_INCREF(Py_None);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":133 */
  __pyx_1 = PyInt_FromLong(__pyx_v_method); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(__pyx_v_methodType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; goto __pyx_L1;}
  Py_DECREF(__pyx_v_m);
  __pyx_v_m = __pyx_1;
  __pyx_1 = 0;
  Py_DECREF(__pyx_v_t);
  __pyx_v_t = __pyx_2;
  __pyx_2 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":134 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_SSLv2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_v_m, __pyx_1, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; goto __pyx_L1;}
  __pyx_3 = __pyx_3 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_3) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":135 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_CLIENT); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_2, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":136 */
      __pyx_r = SSLv2_client_method();
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_SERVER); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_1, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":138 */
      __pyx_r = SSLv2_server_method();
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_GENERIC); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_2, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":140 */
      __pyx_r = SSLv2_method();
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;
    goto __pyx_L2;
  }
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_SSLv3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_v_m, __pyx_1, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; goto __pyx_L1;}
  __pyx_3 = __pyx_3 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_3) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":142 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_CLIENT); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_2, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":143 */
      __pyx_r = SSLv3_client_method();
      goto __pyx_L0;
      goto __pyx_L4;
    }
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_SERVER); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_1, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":145 */
      __pyx_r = SSLv3_server_method();
      goto __pyx_L0;
      goto __pyx_L4;
    }
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_GENERIC); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_2, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":147 */
      __pyx_r = SSLv3_method();
      goto __pyx_L0;
      goto __pyx_L4;
    }
    __pyx_L4:;
    goto __pyx_L2;
  }
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TLSv1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_v_m, __pyx_1, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; goto __pyx_L1;}
  __pyx_3 = __pyx_3 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_3) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":149 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_CLIENT); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 149; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_2, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 149; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":150 */
      __pyx_r = TLSv1_client_method();
      goto __pyx_L0;
      goto __pyx_L5;
    }
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_SERVER); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_1, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":152 */
      __pyx_r = TLSv1_server_method();
      goto __pyx_L0;
      goto __pyx_L5;
    }
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_GENERIC); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_2, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":154 */
      __pyx_r = TLSv1_method();
      goto __pyx_L0;
      goto __pyx_L5;
    }
    __pyx_L5:;
    goto __pyx_L2;
  }
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_SSLv23); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_v_m, __pyx_1, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; goto __pyx_L1;}
  __pyx_3 = __pyx_3 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_3) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":156 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_CLIENT); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_2, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":157 */
      __pyx_r = SSLv23_client_method();
      goto __pyx_L0;
      goto __pyx_L6;
    }
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_SERVER); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_1, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":159 */
      __pyx_r = SSLv23_server_method();
      goto __pyx_L0;
      goto __pyx_L6;
    }
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_GENERIC); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_t, __pyx_2, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    if (__pyx_3) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":161 */
      __pyx_r = SSLv23_method();
      goto __pyx_L0;
      goto __pyx_L6;
    }
    __pyx_L6:;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":162 */
  __pyx_r = 0;
  goto __pyx_L0;

  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_WriteUnraisable("ncrypt_ssl.getSSLMethod");
  __pyx_L0:;
  Py_DECREF(__pyx_v_m);
  Py_DECREF(__pyx_v_t);
  return __pyx_r;
}

static int __pyx_f_10ncrypt_ssl_SelfSignedVerifyCallback(int __pyx_v_preverify_ok,X509_STORE_CTX (*__pyx_v_ctx)) {
  int __pyx_v_verifyErr;
  int __pyx_r;
  int __pyx_1;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":165 */
  __pyx_1 = __pyx_v_preverify_ok;
  if (__pyx_1) {
    __pyx_r = 1;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":167 */
  __pyx_v_verifyErr = X509_STORE_CTX_get_error(__pyx_v_ctx);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":168 */
  __pyx_1 = (__pyx_v_verifyErr == X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":169 */
    __pyx_r = 1;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":170 */
  __pyx_r = 0;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

static int __pyx_f_10ncrypt_ssl_10SSLContext___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_10ncrypt_ssl_10SSLContext___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_sslMethod = 0;
  PyObject *__pyx_v_sslMethodType = 0;
  int __pyx_r;
  static char *__pyx_argnames[] = {"sslMethod","sslMethodType",0};
  __pyx_v_sslMethodType = __pyx_k13;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O|O", __pyx_argnames, &__pyx_v_sslMethod, &__pyx_v_sslMethodType)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_sslMethod);
  Py_INCREF(__pyx_v_sslMethodType);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":176 */
  ((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c = 0;

  __pyx_r = 0;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_sslMethod);
  Py_DECREF(__pyx_v_sslMethodType);
  return __pyx_r;
}

static void __pyx_f_10ncrypt_ssl_10SSLContext___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_f_10ncrypt_ssl_10SSLContext___dealloc__(PyObject *__pyx_v_self) {
  int __pyx_1;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":179 */
  __pyx_1 = (((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c != 0);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":180 */
    SSL_CTX_free(((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c);
    goto __pyx_L2;
  }
  __pyx_L2:;

  Py_DECREF(__pyx_v_self);
}

static PyObject *__pyx_n_ValueError;

static PyObject *__pyx_k15p;
static PyObject *__pyx_k16p;
static PyObject *__pyx_k17p;

static char (__pyx_k15[]) = "invalid ssl method";
static char (__pyx_k16[]) = "invalid ssl method type";
static char (__pyx_k17[]) = "unable to initialize ssl context";

static int __pyx_f_10ncrypt_ssl_10SSLContext___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_10ncrypt_ssl_10SSLContext___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_sslMethod;
  int __pyx_v_sslMethodType;
  int __pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {"sslMethod","sslMethodType",0};
  __pyx_v_sslMethodType = __pyx_k14;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "i|i", __pyx_argnames, &__pyx_v_sslMethod, &__pyx_v_sslMethodType)) return -1;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":183 */
  __pyx_1 = (__pyx_v_sslMethod < 0);
  if (!__pyx_1) {
    __pyx_2 = PyInt_FromLong(__pyx_v_sslMethod); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; goto __pyx_L1;}
    __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_MAX); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_2, __pyx_3, &__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; goto __pyx_L1;}
    __pyx_1 = __pyx_1 >= 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
  }
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":184 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k15p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":185 */
  __pyx_1 = (__pyx_v_sslMethodType == (-1));
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":186 */
    __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_GENERIC); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; goto __pyx_L1;}
    __pyx_1 = PyInt_AsLong(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_v_sslMethodType = __pyx_1;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":187 */
  __pyx_1 = (__pyx_v_sslMethodType < 0);
  if (!__pyx_1) {
    __pyx_2 = PyInt_FromLong(__pyx_v_sslMethodType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; goto __pyx_L1;}
    __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_METHOD_TYPE_MAX); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_2, __pyx_3, &__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; goto __pyx_L1;}
    __pyx_1 = __pyx_1 >= 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
  }
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":188 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k16p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; goto __pyx_L1;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":189 */
  __pyx_1 = (((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c != 0);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":190 */
    SSL_CTX_free(((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c);

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":191 */
    ((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c = 0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":192 */
  ((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c = SSL_CTX_new(__pyx_f_10ncrypt_ssl_getSSLMethod(__pyx_v_sslMethod,__pyx_v_sslMethodType));

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":193 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c != 0));
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":194 */
    __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; goto __pyx_L1;}
    __Pyx_Raise(__pyx_3, __pyx_k17p, 0);
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; goto __pyx_L1;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":195 */
  SSL_CTX_set_session_cache_mode(((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c,((long )SSL_SESS_CACHE_OFF));

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":196 */
  SSL_CTX_set_mode(((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c,((long )SSL_MODE_ACCEPT_MOVING_WRITE_BUFFER));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("ncrypt_ssl.SSLContext.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k18p;
static PyObject *__pyx_k19p;

static char (__pyx_k18[]) = "unable to allocate X509 certificate";
static char (__pyx_k19[]) = "unable to set certificate";

static PyObject *__pyx_f_10ncrypt_ssl_10SSLContext_setCertificate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_10SSLContext_setCertificate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_11ncrypt_x509_X509Certificate *__pyx_v_x = 0;
  X509 (*__pyx_v_x1);
  int __pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"x",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_x)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_x);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_x), __pyx_ptype_11ncrypt_x509_X509Certificate, 0, "x")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; goto __pyx_L1;}

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":200 */
  __pyx_v_x1 = X509_dup(__pyx_v_x->x);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":201 */
  __pyx_1 = (!(__pyx_v_x1 != 0));
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":202 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k18p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":204 */
  /*try:*/ {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":205 */
    __pyx_v_result = SSL_CTX_use_certificate(((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c,__pyx_v_x1);

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":206 */
    __pyx_1 = (!__pyx_v_result);
    if (__pyx_1) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":207 */
      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; goto __pyx_L4;}
      __Pyx_Raise(__pyx_2, __pyx_k19p, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; goto __pyx_L4;}
      goto __pyx_L6;
    }
    __pyx_L6:;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      PyErr_Fetch(&__pyx_2, &__pyx_3, &__pyx_4);
      __pyx_1 = __pyx_lineno;
      goto __pyx_L5;
    }
    __pyx_L5:;

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":209 */
    X509_free(__pyx_v_x1);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_2, __pyx_3, __pyx_4);
        __pyx_lineno = __pyx_1;
        __pyx_2 = 0;
        __pyx_3 = 0;
        __pyx_4 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_ssl.SSLContext.setCertificate");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_x);
  return __pyx_r;
}

static PyObject *__pyx_n_hasPrivateKey;

static PyObject *__pyx_k20p;
static PyObject *__pyx_k21p;
static PyObject *__pyx_k22p;

static char (__pyx_k20[]) = "RSA private key not initialized";
static char (__pyx_k21[]) = "unable to allocate RSA private key";
static char (__pyx_k22[]) = "unable to set RSA private key";

static PyObject *__pyx_f_10ncrypt_ssl_10SSLContext_setPrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_10SSLContext_setPrivateKey(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10ncrypt_rsa_RSAKey *__pyx_v_rk = 0;
  RSA (*__pyx_v_rk1);
  int __pyx_v_result;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  int __pyx_4;
  PyObject *__pyx_5 = 0;
  static char *__pyx_argnames[] = {"rk",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_rk)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_rk);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_rk), __pyx_ptype_10ncrypt_rsa_RSAKey, 0, "rk")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; goto __pyx_L1;}

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":212 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_rk), __pyx_n_hasPrivateKey); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; goto __pyx_L1;}
  __pyx_2 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_3 = PyObject_IsTrue(__pyx_2); if (__pyx_3 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = (!__pyx_3);
  if (__pyx_4) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":213 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; goto __pyx_L1;}
    __Pyx_Raise(__pyx_1, __pyx_k20p, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":215 */
  __pyx_v_rk1 = RSAPrivateKey_dup(__pyx_v_rk->rsa);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":216 */
  __pyx_3 = (!(__pyx_v_rk1 != 0));
  if (__pyx_3) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":217 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k21p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":219 */
  /*try:*/ {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":220 */
    __pyx_v_result = SSL_CTX_use_RSAPrivateKey(((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c,__pyx_v_rk1);

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":221 */
    __pyx_4 = (!__pyx_v_result);
    if (__pyx_4) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":222 */
      __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; goto __pyx_L5;}
      __Pyx_Raise(__pyx_1, __pyx_k22p, 0);
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; goto __pyx_L5;}
      goto __pyx_L7;
    }
    __pyx_L7:;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L6;
    __pyx_L5: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      Py_XDECREF(__pyx_1); __pyx_1 = 0;
      PyErr_Fetch(&__pyx_2, &__pyx_1, &__pyx_5);
      __pyx_3 = __pyx_lineno;
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":224 */
    RSA_free(__pyx_v_rk1);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_2, __pyx_1, __pyx_5);
        __pyx_lineno = __pyx_3;
        __pyx_2 = 0;
        __pyx_1 = 0;
        __pyx_5 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("ncrypt_ssl.SSLContext.setPrivateKey");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_rk);
  return __pyx_r;
}

static PyObject *__pyx_k23p;

static char (__pyx_k23[]) = "invalid verification mode";

static PyObject *__pyx_f_10ncrypt_ssl_10SSLContext_setVerifyMode(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_10SSLContext_setVerifyMode(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_mode;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {"mode",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "i", __pyx_argnames, &__pyx_v_mode)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":227 */
  __pyx_1 = (__pyx_v_mode < 0);
  if (!__pyx_1) {
    __pyx_2 = PyInt_FromLong(__pyx_v_mode); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; goto __pyx_L1;}
    __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_VERIFY_MODE_MAX); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_2, __pyx_3, &__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; goto __pyx_L1;}
    __pyx_1 = __pyx_1 >= 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
  }
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":228 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k23p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":229 */
  __pyx_3 = PyInt_FromLong(__pyx_v_mode); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_VERIFY_MODE_NONE); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_3, __pyx_2, &__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
  __pyx_1 = __pyx_1 == 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":230 */
    SSL_CTX_set_verify(((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c,SSL_VERIFY_NONE,0);
    goto __pyx_L3;
  }
  __pyx_3 = PyInt_FromLong(__pyx_v_mode); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSL_VERIFY_MODE_SELF_SIGNED); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_3, __pyx_2, &__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; goto __pyx_L1;}
  __pyx_1 = __pyx_1 == 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":232 */
    SSL_CTX_set_verify(((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c,((SSL_VERIFY_PEER | SSL_VERIFY_FAIL_IF_NO_PEER_CERT) | SSL_VERIFY_CLIENT_ONCE),__pyx_f_10ncrypt_ssl_SelfSignedVerifyCallback);
    goto __pyx_L3;
  }
  __pyx_L3:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("ncrypt_ssl.SSLContext.setVerifyMode");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k24p;

static char (__pyx_k24[]) = "unable to enable dh";

static PyObject *__pyx_f_10ncrypt_ssl_10SSLContext_enableDH(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_10SSLContext_enableDH(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_9ncrypt_dh_DH *__pyx_v_dh = 0;
  long __pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {"dh",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_dh)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_dh);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dh), __pyx_ptype_9ncrypt_dh_DH, 0, "dh")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":238 */
  __pyx_v_result = SSL_CTX_set_tmp_dh(((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c,__pyx_v_dh->dh);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":239 */
  __pyx_1 = (!__pyx_v_result);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":240 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k24p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":241 */
  SSL_CTX_set_options(((struct __pyx_obj_10ncrypt_ssl_SSLContext *)__pyx_v_self)->c,SSL_OP_SINGLE_DH_USE);

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_ssl.SSLContext.enableDH");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_dh);
  return __pyx_r;
}

static int __pyx_f_10ncrypt_ssl_13SSLConnection___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_10ncrypt_ssl_13SSLConnection___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_sslContext = 0;
  PyObject *__pyx_v_sock = 0;
  int __pyx_r;
  static char *__pyx_argnames[] = {"sslContext","sock",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO", __pyx_argnames, &__pyx_v_sslContext, &__pyx_v_sock)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_sslContext);
  Py_INCREF(__pyx_v_sock);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":249 */
  ((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s = 0;

  __pyx_r = 0;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_sslContext);
  Py_DECREF(__pyx_v_sock);
  return __pyx_r;
}

static void __pyx_f_10ncrypt_ssl_13SSLConnection___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_f_10ncrypt_ssl_13SSLConnection___dealloc__(PyObject *__pyx_v_self) {
  int __pyx_1;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":252 */
  __pyx_1 = (((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s != 0);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":253 */
    SSL_free(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s);
    goto __pyx_L2;
  }
  __pyx_L2:;

  Py_DECREF(__pyx_v_self);
}

static PyObject *__pyx_n_fileno;

static PyObject *__pyx_k25p;
static PyObject *__pyx_k26p;

static char (__pyx_k25[]) = "unable to initialize ssl state";
static char (__pyx_k26[]) = "unable to set socket fd";

static int __pyx_f_10ncrypt_ssl_13SSLConnection___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_10ncrypt_ssl_13SSLConnection___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10ncrypt_ssl_SSLContext *__pyx_v_sslContext = 0;
  PyObject *__pyx_v_sock = 0;
  int __pyx_v_result;
  int __pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {"sslContext","sock",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO", __pyx_argnames, &__pyx_v_sslContext, &__pyx_v_sock)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_sslContext);
  Py_INCREF(__pyx_v_sock);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sslContext), __pyx_ptype_10ncrypt_ssl_SSLContext, 0, "sslContext")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; goto __pyx_L1;}

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":256 */
  __pyx_1 = (((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s != 0);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":257 */
    SSL_free(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s);

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":258 */
    ((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s = 0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":259 */
  ((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s = SSL_new(__pyx_v_sslContext->c);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":260 */
  __pyx_1 = (!(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s != 0));
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":261 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k25p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":262 */
  Py_INCREF(((PyObject *)__pyx_v_sslContext));
  Py_DECREF(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->sslContext);
  ((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->sslContext = ((PyObject *)__pyx_v_sslContext);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":263 */
  Py_INCREF(__pyx_v_sock);
  Py_DECREF(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->sock);
  ((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->sock = __pyx_v_sock;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":265 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_sock, __pyx_n_fileno); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; goto __pyx_L1;}
  __pyx_3 = PyObject_CallObject(__pyx_2, 0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyInt_AsLong(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_v_result = SSL_set_fd(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s,__pyx_1);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":266 */
  __pyx_1 = (__pyx_v_result == 0);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":267 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k26p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; goto __pyx_L1;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("ncrypt_ssl.SSLConnection.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_sslContext);
  Py_DECREF(__pyx_v_sock);
  return __pyx_r;
}

static PyObject *__pyx_k27p;
static PyObject *__pyx_k28p;
static PyObject *__pyx_k29p;
static PyObject *__pyx_k30p;
static PyObject *__pyx_k31p;
static PyObject *__pyx_k32p;
static PyObject *__pyx_k33p;

static char (__pyx_k27[]) = "SSL needs more readable data";
static char (__pyx_k28[]) = "SSL needs to write more data";
static char (__pyx_k29[]) = "SSL x509 callback is pending";
static char (__pyx_k30[]) = "SSL connection has shutdown";
static char (__pyx_k31[]) = "SSL internal syscall error";
static char (__pyx_k32[]) = "SSL protocol error";
static char (__pyx_k33[]) = "unknown SSL error";

static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_getSSLError(struct __pyx_obj_10ncrypt_ssl_SSLConnection *__pyx_v_self,int __pyx_v_result) {
  int __pyx_v_err;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":271 */
  __pyx_v_err = SSL_get_error(__pyx_v_self->s,__pyx_v_result);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":272 */
  __pyx_1 = (__pyx_v_err == SSL_ERROR_WANT_READ);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":273 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLWantReadError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; goto __pyx_L1;}
    Py_INCREF(__pyx_k27p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k27p);
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_r = __pyx_4;
    __pyx_4 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":274 */
  __pyx_1 = (__pyx_v_err == SSL_ERROR_WANT_WRITE);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":275 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLWantWriteError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
    Py_INCREF(__pyx_k28p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k28p);
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_r = __pyx_4;
    __pyx_4 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":276 */
  __pyx_1 = (__pyx_v_err == SSL_ERROR_WANT_X509_LOOKUP);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":277 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLWantX509LookupError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; goto __pyx_L1;}
    Py_INCREF(__pyx_k29p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k29p);
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_r = __pyx_4;
    __pyx_4 = 0;
    goto __pyx_L0;
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":278 */
  __pyx_1 = (__pyx_v_err == SSL_ERROR_ZERO_RETURN);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":279 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLZeroReturnError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; goto __pyx_L1;}
    Py_INCREF(__pyx_k30p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k30p);
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_r = __pyx_4;
    __pyx_4 = 0;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":280 */
  __pyx_1 = (__pyx_v_err == SSL_ERROR_SYSCALL);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":281 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLSysCallError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; goto __pyx_L1;}
    Py_INCREF(__pyx_k31p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k31p);
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_r = __pyx_4;
    __pyx_4 = 0;
    goto __pyx_L0;
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":282 */
  __pyx_1 = (__pyx_v_err == SSL_ERROR_SSL);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":283 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLProtocolError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
    Py_INCREF(__pyx_k32p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k32p);
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_r = __pyx_4;
    __pyx_4 = 0;
    goto __pyx_L0;
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":284 */
  if (!(__pyx_v_err != SSL_ERROR_NONE)) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
  }

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":285 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
  Py_INCREF(__pyx_k33p);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k33p);
  __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_r = __pyx_4;
  __pyx_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_ssl.SSLConnection.getSSLError");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_connect(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_connect(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":288 */
  ERR_clear_error();

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":290 */
  __pyx_v_result = SSL_connect(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":291 */
  __pyx_1 = (__pyx_v_result <= 0);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":292 */
    __pyx_2 = ((struct __pyx_vtabstruct_10ncrypt_ssl_SSLConnection *)((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->__pyx_vtab)->getSSLError(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self),__pyx_v_result); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_ssl.SSLConnection.connect");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_accept(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_accept(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":295 */
  ERR_clear_error();

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":297 */
  __pyx_v_result = SSL_accept(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":298 */
  __pyx_1 = (__pyx_v_result <= 0);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":299 */
    __pyx_2 = ((struct __pyx_vtabstruct_10ncrypt_ssl_SSLConnection *)((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->__pyx_vtab)->getSSLError(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self),__pyx_v_result); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_ssl.SSLConnection.accept");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_getVerifyResult(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_getVerifyResult(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":302 */
  __pyx_1 = PyInt_FromLong(SSL_get_verify_result(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("ncrypt_ssl.SSLConnection.getVerifyResult");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k34p;
static PyObject *__pyx_k35p;

static char (__pyx_k34[]) = "no peer certificate available";
static char (__pyx_k35[]) = "unable to allocate copy certificate";

static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_getPeerCertificate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_getPeerCertificate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  X509 (*__pyx_v_x);
  struct __pyx_obj_11ncrypt_x509_X509Certificate *__pyx_v_cert;
  int __pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);
  __pyx_v_cert = ((struct __pyx_obj_11ncrypt_x509_X509Certificate *)Py_None); Py_INCREF(Py_None);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":306 */
  __pyx_v_x = SSL_get_peer_certificate(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":307 */
  __pyx_1 = (!(__pyx_v_x != 0));
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":308 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLCertificateError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k34p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":311 */
  /*try:*/ {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":312 */
    __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_11ncrypt_x509_X509Certificate), 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; goto __pyx_L4;}
    if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_11ncrypt_x509_X509Certificate)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; goto __pyx_L4;}
    Py_DECREF(((PyObject *)__pyx_v_cert));
    __pyx_v_cert = ((struct __pyx_obj_11ncrypt_x509_X509Certificate *)__pyx_2);
    __pyx_2 = 0;

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":313 */
    __pyx_v_result = ((struct __pyx_vtabstruct_11ncrypt_x509_X509Certificate *)__pyx_v_cert->__pyx_vtab)->fromX509(__pyx_v_cert,__pyx_v_x);

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":314 */
    __pyx_1 = (!__pyx_v_result);
    if (__pyx_1) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":315 */
      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 315; goto __pyx_L4;}
      __Pyx_Raise(__pyx_2, __pyx_k35p, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 315; goto __pyx_L4;}
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":316 */
    Py_INCREF(((PyObject *)__pyx_v_cert));
    __pyx_r = ((PyObject *)__pyx_v_cert);
    goto __pyx_L3;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L3: __pyx_why = 3; goto __pyx_L5;
    __pyx_L4: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      PyErr_Fetch(&__pyx_2, &__pyx_3, &__pyx_4);
      __pyx_1 = __pyx_lineno;
      goto __pyx_L5;
    }
    __pyx_L5:;

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":318 */
    X509_free(__pyx_v_x);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_2, __pyx_3, __pyx_4);
        __pyx_lineno = __pyx_1;
        __pyx_2 = 0;
        __pyx_3 = 0;
        __pyx_4 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_ssl.SSLConnection.getPeerCertificate");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_cert);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_pending(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_pending(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":321 */
  __pyx_1 = PyInt_FromLong(SSL_pending(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("ncrypt_ssl.SSLConnection.pending");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_MemoryError;
static PyObject *__pyx_n_isinstance;

static PyObject *__pyx_k36p;
static PyObject *__pyx_k37p;

static char (__pyx_k36[]) = "unable to allocate string";
static char (__pyx_k37[]) = "";

static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_recv(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_recv(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_bufsize;
  PyObject (*__pyx_v_buf);
  char (*__pyx_v_ptr);
  int __pyx_v_result;
  PyObject *__pyx_v_e;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"bufsize",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "i", __pyx_argnames, &__pyx_v_bufsize)) return 0;
  Py_INCREF(__pyx_v_self);
  __pyx_v_e = Py_None; Py_INCREF(Py_None);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":324 */
  ERR_clear_error();

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":327 */
  __pyx_v_buf = PyString_FromStringAndSize(0,__pyx_v_bufsize);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":328 */
  __pyx_1 = (!(__pyx_v_buf != 0));
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":329 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_MemoryError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k36p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":331 */
  /*try:*/ {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":332 */
    __pyx_v_ptr = PyString_AsString(__pyx_v_buf);

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":333 */
    if (!(__pyx_v_ptr != 0)) {
      PyErr_SetNone(PyExc_AssertionError);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; goto __pyx_L4;}
    }

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":334 */
    __pyx_v_result = SSL_read(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s,__pyx_v_ptr,__pyx_v_bufsize);

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":335 */
    __pyx_1 = (__pyx_v_result <= 0);
    if (__pyx_1) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":336 */
      __pyx_2 = ((struct __pyx_vtabstruct_10ncrypt_ssl_SSLConnection *)((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->__pyx_vtab)->getSSLError(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self),__pyx_v_result); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; goto __pyx_L4;}
      Py_DECREF(__pyx_v_e);
      __pyx_v_e = __pyx_2;
      __pyx_2 = 0;

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":337 */
      __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_isinstance); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; goto __pyx_L4;}
      __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSLZeroReturnError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; goto __pyx_L4;}
      __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; goto __pyx_L4;}
      Py_INCREF(__pyx_v_e);
      PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_e);
      PyTuple_SET_ITEM(__pyx_4, 1, __pyx_3);
      __pyx_3 = 0;
      __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; goto __pyx_L4;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __pyx_1 = PyObject_IsTrue(__pyx_3); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; goto __pyx_L4;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      if (__pyx_1) {

        /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":338 */
        Py_INCREF(__pyx_k37p);
        __pyx_r = __pyx_k37p;
        goto __pyx_L3;
        goto __pyx_L7;
      }
      __pyx_L7:;

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":339 */
      __Pyx_Raise(__pyx_v_e, 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; goto __pyx_L4;}
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":340 */
    __pyx_1 = (__pyx_v_result != __pyx_v_bufsize);
    if (__pyx_1) {

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":341 */
      __pyx_v_result = _PyString_Resize((&__pyx_v_buf),__pyx_v_result);

      /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":342 */
      if (!(__pyx_v_result == 0)) {
        PyErr_SetNone(PyExc_AssertionError);
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L4;}
      }
      goto __pyx_L8;
    }
    __pyx_L8:;

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":343 */
    __pyx_2 = (PyObject *)__pyx_v_buf;
    Py_INCREF(__pyx_2);
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L3;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L3: __pyx_why = 3; goto __pyx_L5;
    __pyx_L4: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_4); __pyx_4 = 0;
      Py_XDECREF(__pyx_3); __pyx_3 = 0;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      PyErr_Fetch(&__pyx_4, &__pyx_3, &__pyx_2);
      __pyx_1 = __pyx_lineno;
      goto __pyx_L5;
    }
    __pyx_L5:;

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":345 */
    Py_XDECREF(__pyx_v_buf);
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_4, __pyx_3, __pyx_2);
        __pyx_lineno = __pyx_1;
        __pyx_4 = 0;
        __pyx_3 = 0;
        __pyx_2 = 0;
        goto __pyx_L1;
      }
    }
  }

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_ssl.SSLConnection.recv");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_e);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_TypeError;

static PyObject *__pyx_k38p;

static char (__pyx_k38[]) = "a string is expected";

static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_send(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_send(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_data = 0;
  char (*__pyx_v_ptr);
  int __pyx_v_dataLen;
  int __pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {"data",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_data)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_data);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":348 */
  ERR_clear_error();

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":351 */
  __pyx_v_result = PyString_AsStringAndSize(((PyObject (*))__pyx_v_data),(&__pyx_v_ptr),(&__pyx_v_dataLen));

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":352 */
  __pyx_1 = (__pyx_v_result < 0);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":353 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_TypeError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k38p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":354 */
  __pyx_1 = (__pyx_v_dataLen == 0);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":355 */
    __pyx_2 = PyInt_FromLong(0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; goto __pyx_L1;}
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":356 */
  __pyx_v_result = SSL_write(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s,__pyx_v_ptr,__pyx_v_dataLen);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":357 */
  __pyx_1 = (__pyx_v_result <= 0);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":358 */
    __pyx_2 = ((struct __pyx_vtabstruct_10ncrypt_ssl_SSLConnection *)((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->__pyx_vtab)->getSSLError(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self),__pyx_v_result); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; goto __pyx_L1;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":359 */
  __pyx_2 = PyInt_FromLong(__pyx_v_result); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_ssl.SSLConnection.send");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_data);
  return __pyx_r;
}

static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_shutdown(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10ncrypt_ssl_13SSLConnection_shutdown(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":363 */
  __pyx_v_result = SSL_shutdown(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->s);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":364 */
  __pyx_1 = (__pyx_v_result < 0);
  if (__pyx_1) {

    /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":365 */
    __pyx_2 = ((struct __pyx_vtabstruct_10ncrypt_ssl_SSLConnection *)((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self)->__pyx_vtab)->getSSLError(((struct __pyx_obj_10ncrypt_ssl_SSLConnection *)__pyx_v_self),__pyx_v_result); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":366 */
  __pyx_2 = PyInt_FromLong(__pyx_v_result); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("ncrypt_ssl.SSLConnection.shutdown");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static __Pyx_InternTabEntry __pyx_intern_tab[] = {
  {&__pyx_n_BaseError, "BaseError"},
  {&__pyx_n_LibraryErrorInfo, "LibraryErrorInfo"},
  {&__pyx_n_MemoryError, "MemoryError"},
  {&__pyx_n_SSLCertificateError, "SSLCertificateError"},
  {&__pyx_n_SSLError, "SSLError"},
  {&__pyx_n_SSLLibraryError, "SSLLibraryError"},
  {&__pyx_n_SSLProtocolError, "SSLProtocolError"},
  {&__pyx_n_SSLSysCallError, "SSLSysCallError"},
  {&__pyx_n_SSLWantError, "SSLWantError"},
  {&__pyx_n_SSLWantReadError, "SSLWantReadError"},
  {&__pyx_n_SSLWantWriteError, "SSLWantWriteError"},
  {&__pyx_n_SSLWantX509LookupError, "SSLWantX509LookupError"},
  {&__pyx_n_SSLZeroReturnError, "SSLZeroReturnError"},
  {&__pyx_n_SSL_METHOD_MAX, "SSL_METHOD_MAX"},
  {&__pyx_n_SSL_METHOD_SSLv2, "SSL_METHOD_SSLv2"},
  {&__pyx_n_SSL_METHOD_SSLv23, "SSL_METHOD_SSLv23"},
  {&__pyx_n_SSL_METHOD_SSLv3, "SSL_METHOD_SSLv3"},
  {&__pyx_n_SSL_METHOD_TLSv1, "SSL_METHOD_TLSv1"},
  {&__pyx_n_SSL_METHOD_TYPE_CLIENT, "SSL_METHOD_TYPE_CLIENT"},
  {&__pyx_n_SSL_METHOD_TYPE_GENERIC, "SSL_METHOD_TYPE_GENERIC"},
  {&__pyx_n_SSL_METHOD_TYPE_MAX, "SSL_METHOD_TYPE_MAX"},
  {&__pyx_n_SSL_METHOD_TYPE_SERVER, "SSL_METHOD_TYPE_SERVER"},
  {&__pyx_n_SSL_VERIFY_MODE_MAX, "SSL_VERIFY_MODE_MAX"},
  {&__pyx_n_SSL_VERIFY_MODE_NONE, "SSL_VERIFY_MODE_NONE"},
  {&__pyx_n_SSL_VERIFY_MODE_SELF_SIGNED, "SSL_VERIFY_MODE_SELF_SIGNED"},
  {&__pyx_n_TypeError, "TypeError"},
  {&__pyx_n_ValueError, "ValueError"},
  {&__pyx_n___init__, "__init__"},
  {&__pyx_n_fileno, "fileno"},
  {&__pyx_n_hasPrivateKey, "hasPrivateKey"},
  {&__pyx_n_initErrorInfo, "initErrorInfo"},
  {&__pyx_n_isinstance, "isinstance"},
  {&__pyx_n_ncrypt_dh, "ncrypt_dh"},
  {&__pyx_n_ncrypt_err, "ncrypt_err"},
  {&__pyx_n_ncrypt_rsa, "ncrypt_rsa"},
  {&__pyx_n_ncrypt_x509, "ncrypt_x509"},
  {&__pyx_n_updateArgs, "updateArgs"},
  {0, 0}
};

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_k15p, __pyx_k15, sizeof(__pyx_k15)},
  {&__pyx_k16p, __pyx_k16, sizeof(__pyx_k16)},
  {&__pyx_k17p, __pyx_k17, sizeof(__pyx_k17)},
  {&__pyx_k18p, __pyx_k18, sizeof(__pyx_k18)},
  {&__pyx_k19p, __pyx_k19, sizeof(__pyx_k19)},
  {&__pyx_k20p, __pyx_k20, sizeof(__pyx_k20)},
  {&__pyx_k21p, __pyx_k21, sizeof(__pyx_k21)},
  {&__pyx_k22p, __pyx_k22, sizeof(__pyx_k22)},
  {&__pyx_k23p, __pyx_k23, sizeof(__pyx_k23)},
  {&__pyx_k24p, __pyx_k24, sizeof(__pyx_k24)},
  {&__pyx_k25p, __pyx_k25, sizeof(__pyx_k25)},
  {&__pyx_k26p, __pyx_k26, sizeof(__pyx_k26)},
  {&__pyx_k27p, __pyx_k27, sizeof(__pyx_k27)},
  {&__pyx_k28p, __pyx_k28, sizeof(__pyx_k28)},
  {&__pyx_k29p, __pyx_k29, sizeof(__pyx_k29)},
  {&__pyx_k30p, __pyx_k30, sizeof(__pyx_k30)},
  {&__pyx_k31p, __pyx_k31, sizeof(__pyx_k31)},
  {&__pyx_k32p, __pyx_k32, sizeof(__pyx_k32)},
  {&__pyx_k33p, __pyx_k33, sizeof(__pyx_k33)},
  {&__pyx_k34p, __pyx_k34, sizeof(__pyx_k34)},
  {&__pyx_k35p, __pyx_k35, sizeof(__pyx_k35)},
  {&__pyx_k36p, __pyx_k36, sizeof(__pyx_k36)},
  {&__pyx_k37p, __pyx_k37, sizeof(__pyx_k37)},
  {&__pyx_k38p, __pyx_k38, sizeof(__pyx_k38)},
  {0, 0, 0}
};

static PyObject *__pyx_tp_new_10ncrypt_ssl_SSLContext(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (__pyx_f_10ncrypt_ssl_10SSLContext___new__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_10ncrypt_ssl_SSLContext(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++o->ob_refcnt;
    __pyx_f_10ncrypt_ssl_10SSLContext___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --o->ob_refcnt;
    PyErr_Restore(etype, eval, etb);
  }
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_10ncrypt_ssl_SSLContext(PyObject *o, visitproc v, void *a) {
  return 0;
}

static int __pyx_tp_clear_10ncrypt_ssl_SSLContext(PyObject *o) {
  return 0;
}

static struct PyMethodDef __pyx_methods_10ncrypt_ssl_SSLContext[] = {
  {"setCertificate", (PyCFunction)__pyx_f_10ncrypt_ssl_10SSLContext_setCertificate, METH_VARARGS|METH_KEYWORDS, 0},
  {"setPrivateKey", (PyCFunction)__pyx_f_10ncrypt_ssl_10SSLContext_setPrivateKey, METH_VARARGS|METH_KEYWORDS, 0},
  {"setVerifyMode", (PyCFunction)__pyx_f_10ncrypt_ssl_10SSLContext_setVerifyMode, METH_VARARGS|METH_KEYWORDS, 0},
  {"enableDH", (PyCFunction)__pyx_f_10ncrypt_ssl_10SSLContext_enableDH, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_SSLContext = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
};

static PySequenceMethods __pyx_tp_as_sequence_SSLContext = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_SSLContext = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_SSLContext = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_10ncrypt_ssl_SSLContext = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "ncrypt_ssl.SSLContext", /*tp_name*/
  sizeof(struct __pyx_obj_10ncrypt_ssl_SSLContext), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_10ncrypt_ssl_SSLContext, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_SSLContext, /*tp_as_number*/
  &__pyx_tp_as_sequence_SSLContext, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_SSLContext, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_SSLContext, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_10ncrypt_ssl_SSLContext, /*tp_traverse*/
  __pyx_tp_clear_10ncrypt_ssl_SSLContext, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_10ncrypt_ssl_SSLContext, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_10ncrypt_ssl_10SSLContext___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_10ncrypt_ssl_SSLContext, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};
static struct __pyx_vtabstruct_10ncrypt_ssl_SSLConnection __pyx_vtable_10ncrypt_ssl_SSLConnection;

static PyObject *__pyx_tp_new_10ncrypt_ssl_SSLConnection(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  struct __pyx_obj_10ncrypt_ssl_SSLConnection *p = (struct __pyx_obj_10ncrypt_ssl_SSLConnection *)o;
  *(struct __pyx_vtabstruct_10ncrypt_ssl_SSLConnection **)&p->__pyx_vtab = __pyx_vtabptr_10ncrypt_ssl_SSLConnection;
  p->sslContext = Py_None; Py_INCREF(Py_None);
  p->sock = Py_None; Py_INCREF(Py_None);
  if (__pyx_f_10ncrypt_ssl_13SSLConnection___new__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_10ncrypt_ssl_SSLConnection(PyObject *o) {
  struct __pyx_obj_10ncrypt_ssl_SSLConnection *p = (struct __pyx_obj_10ncrypt_ssl_SSLConnection *)o;
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++o->ob_refcnt;
    __pyx_f_10ncrypt_ssl_13SSLConnection___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --o->ob_refcnt;
    PyErr_Restore(etype, eval, etb);
  }
  Py_XDECREF(p->sslContext);
  Py_XDECREF(p->sock);
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_10ncrypt_ssl_SSLConnection(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_10ncrypt_ssl_SSLConnection *p = (struct __pyx_obj_10ncrypt_ssl_SSLConnection *)o;
  if (p->sslContext) {
    e = (*v)(p->sslContext, a); if (e) return e;
  }
  if (p->sock) {
    e = (*v)(p->sock, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_10ncrypt_ssl_SSLConnection(PyObject *o) {
  struct __pyx_obj_10ncrypt_ssl_SSLConnection *p = (struct __pyx_obj_10ncrypt_ssl_SSLConnection *)o;
  Py_XDECREF(p->sslContext);
  p->sslContext = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->sock);
  p->sock = Py_None; Py_INCREF(Py_None);
  return 0;
}

static struct PyMethodDef __pyx_methods_10ncrypt_ssl_SSLConnection[] = {
  {"connect", (PyCFunction)__pyx_f_10ncrypt_ssl_13SSLConnection_connect, METH_VARARGS|METH_KEYWORDS, 0},
  {"accept", (PyCFunction)__pyx_f_10ncrypt_ssl_13SSLConnection_accept, METH_VARARGS|METH_KEYWORDS, 0},
  {"getVerifyResult", (PyCFunction)__pyx_f_10ncrypt_ssl_13SSLConnection_getVerifyResult, METH_VARARGS|METH_KEYWORDS, 0},
  {"getPeerCertificate", (PyCFunction)__pyx_f_10ncrypt_ssl_13SSLConnection_getPeerCertificate, METH_VARARGS|METH_KEYWORDS, 0},
  {"pending", (PyCFunction)__pyx_f_10ncrypt_ssl_13SSLConnection_pending, METH_VARARGS|METH_KEYWORDS, 0},
  {"recv", (PyCFunction)__pyx_f_10ncrypt_ssl_13SSLConnection_recv, METH_VARARGS|METH_KEYWORDS, 0},
  {"send", (PyCFunction)__pyx_f_10ncrypt_ssl_13SSLConnection_send, METH_VARARGS|METH_KEYWORDS, 0},
  {"shutdown", (PyCFunction)__pyx_f_10ncrypt_ssl_13SSLConnection_shutdown, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyMemberDef __pyx_members_10ncrypt_ssl_SSLConnection[] = {
  {"sock", T_OBJECT, offsetof(struct __pyx_obj_10ncrypt_ssl_SSLConnection, sock), READONLY, 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_SSLConnection = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
};

static PySequenceMethods __pyx_tp_as_sequence_SSLConnection = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_SSLConnection = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_SSLConnection = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_10ncrypt_ssl_SSLConnection = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "ncrypt_ssl.SSLConnection", /*tp_name*/
  sizeof(struct __pyx_obj_10ncrypt_ssl_SSLConnection), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_10ncrypt_ssl_SSLConnection, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_SSLConnection, /*tp_as_number*/
  &__pyx_tp_as_sequence_SSLConnection, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_SSLConnection, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_SSLConnection, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_10ncrypt_ssl_SSLConnection, /*tp_traverse*/
  __pyx_tp_clear_10ncrypt_ssl_SSLConnection, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_10ncrypt_ssl_SSLConnection, /*tp_methods*/
  __pyx_members_10ncrypt_ssl_SSLConnection, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_10ncrypt_ssl_13SSLConnection___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_10ncrypt_ssl_SSLConnection, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static struct PyMethodDef __pyx_methods[] = {
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

PyMODINIT_FUNC initncrypt_ssl(void); /*proto*/
PyMODINIT_FUNC initncrypt_ssl(void) {
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  __pyx_init_filenames();
  __pyx_m = Py_InitModule4("ncrypt_ssl", __pyx_methods, 0, 0, PYTHON_API_VERSION);
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  __pyx_b = PyImport_AddModule("__builtin__");
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  if (__Pyx_InternStrings(__pyx_intern_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  if (PyType_Ready(&__pyx_type_10ncrypt_ssl_SSLContext) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "SSLContext", (PyObject *)&__pyx_type_10ncrypt_ssl_SSLContext) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; goto __pyx_L1;}
  __pyx_ptype_10ncrypt_ssl_SSLContext = &__pyx_type_10ncrypt_ssl_SSLContext;
  __pyx_vtabptr_10ncrypt_ssl_SSLConnection = &__pyx_vtable_10ncrypt_ssl_SSLConnection;
  *(void(**)())&__pyx_vtable_10ncrypt_ssl_SSLConnection.getSSLError = (void(*)())__pyx_f_10ncrypt_ssl_13SSLConnection_getSSLError;
  __pyx_type_10ncrypt_ssl_SSLConnection.tp_free = _PyObject_GC_Del;
  if (PyType_Ready(&__pyx_type_10ncrypt_ssl_SSLConnection) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; goto __pyx_L1;}
  if (__Pyx_SetVtable(__pyx_type_10ncrypt_ssl_SSLConnection.tp_dict, __pyx_vtabptr_10ncrypt_ssl_SSLConnection) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "SSLConnection", (PyObject *)&__pyx_type_10ncrypt_ssl_SSLConnection) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; goto __pyx_L1;}
  __pyx_ptype_10ncrypt_ssl_SSLConnection = &__pyx_type_10ncrypt_ssl_SSLConnection;
  __pyx_ptype_11ncrypt_x509_X509Certificate = __Pyx_ImportType("ncrypt_x509", "X509Certificate", sizeof(struct __pyx_obj_11ncrypt_x509_X509Certificate)); if (!__pyx_ptype_11ncrypt_x509_X509Certificate) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 4; goto __pyx_L1;}
  if (__Pyx_GetVtable(__pyx_ptype_11ncrypt_x509_X509Certificate->tp_dict, &__pyx_vtabptr_11ncrypt_x509_X509Certificate) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 4; goto __pyx_L1;}
  __pyx_ptype_9ncrypt_dh_DH = __Pyx_ImportType("ncrypt_dh", "DH", sizeof(struct __pyx_obj_9ncrypt_dh_DH)); if (!__pyx_ptype_9ncrypt_dh_DH) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 12; goto __pyx_L1;}
  __pyx_ptype_10ncrypt_rsa_RSAKey = __Pyx_ImportType("ncrypt_rsa", "RSAKey", sizeof(struct __pyx_obj_10ncrypt_rsa_RSAKey)); if (!__pyx_ptype_10ncrypt_rsa_RSAKey) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 17; goto __pyx_L1;}
  if (__Pyx_GetVtable(__pyx_ptype_10ncrypt_rsa_RSAKey->tp_dict, &__pyx_vtabptr_10ncrypt_rsa_RSAKey) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 17; goto __pyx_L1;}

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":10 */
  __pyx_1 = __Pyx_Import(__pyx_n_ncrypt_err, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_ncrypt_err, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":11 */
  __pyx_1 = __Pyx_Import(__pyx_n_ncrypt_x509, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_ncrypt_x509, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":97 */
  __pyx_1 = PyInt_FromLong(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_METHOD_SSLv2, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":98 */
  __pyx_1 = PyInt_FromLong(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_METHOD_SSLv3, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":99 */
  __pyx_1 = PyInt_FromLong(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_METHOD_TLSv1, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":100 */
  __pyx_1 = PyInt_FromLong(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_METHOD_SSLv23, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":101 */
  __pyx_1 = PyInt_FromLong(4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_METHOD_MAX, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":103 */
  __pyx_1 = PyInt_FromLong(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_METHOD_TYPE_CLIENT, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":104 */
  __pyx_1 = PyInt_FromLong(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_METHOD_TYPE_SERVER, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":105 */
  __pyx_1 = PyInt_FromLong(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_METHOD_TYPE_GENERIC, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":106 */
  __pyx_1 = PyInt_FromLong(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_METHOD_TYPE_MAX, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":108 */
  __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_ncrypt_err); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; goto __pyx_L1;}
  __pyx_3 = PyObject_GetAttr(__pyx_2, __pyx_n_BaseError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = __Pyx_CreateClass(__pyx_2, __pyx_1, __pyx_n_SSLError, "ncrypt_ssl"); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSLError, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":110 */
  __pyx_2 = PyDict_New(); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSLError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = __Pyx_CreateClass(__pyx_1, __pyx_2, __pyx_n_SSLCertificateError, "ncrypt_ssl"); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSLCertificateError, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":112 */
  __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSLError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = __Pyx_CreateClass(__pyx_2, __pyx_1, __pyx_n_SSLWantError, "ncrypt_ssl"); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSLWantError, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":113 */
  __pyx_2 = PyDict_New(); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSLWantError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = __Pyx_CreateClass(__pyx_1, __pyx_2, __pyx_n_SSLWantReadError, "ncrypt_ssl"); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSLWantReadError, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":114 */
  __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSLWantError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = __Pyx_CreateClass(__pyx_2, __pyx_1, __pyx_n_SSLWantWriteError, "ncrypt_ssl"); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSLWantWriteError, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":115 */
  __pyx_2 = PyDict_New(); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSLWantError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = __Pyx_CreateClass(__pyx_1, __pyx_2, __pyx_n_SSLWantX509LookupError, "ncrypt_ssl"); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSLWantX509LookupError, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":117 */
  __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSLError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = __Pyx_CreateClass(__pyx_2, __pyx_1, __pyx_n_SSLZeroReturnError, "ncrypt_ssl"); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSLZeroReturnError, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":119 */
  __pyx_2 = PyDict_New(); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSLError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; goto __pyx_L1;}
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_ncrypt_err); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; goto __pyx_L1;}
  __pyx_4 = PyObject_GetAttr(__pyx_1, __pyx_n_LibraryErrorInfo); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyTuple_New(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_4);
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_3 = __Pyx_CreateClass(__pyx_1, __pyx_2, __pyx_n_SSLLibraryError, "ncrypt_ssl"); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":120 */
  __pyx_4 = PyCFunction_New(&__pyx_mdef_10ncrypt_ssl_15SSLLibraryError___init__, 0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; goto __pyx_L1;}
  __pyx_1 = PyMethod_New(__pyx_4, 0, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (PyObject_SetAttr(__pyx_3, __pyx_n___init__, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSLLibraryError, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":125 */
  __pyx_4 = PyDict_New(); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; goto __pyx_L1;}
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_2 = __Pyx_CreateClass(__pyx_3, __pyx_4, __pyx_n_SSLSysCallError, "ncrypt_ssl"); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSLSysCallError, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":126 */
  __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_SSLLibraryError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_4 = __Pyx_CreateClass(__pyx_2, __pyx_1, __pyx_n_SSLProtocolError, "ncrypt_ssl"); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSLProtocolError, __pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":128 */
  __pyx_3 = PyInt_FromLong(0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_VERIFY_MODE_NONE, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":129 */
  __pyx_2 = PyInt_FromLong(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_VERIFY_MODE_SELF_SIGNED, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":130 */
  __pyx_4 = PyInt_FromLong(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_SSL_VERIFY_MODE_MAX, __pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":175 */
  __pyx_1 = PyInt_FromLong((-1)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; goto __pyx_L1;}
  __pyx_k13 = __pyx_1;
  __pyx_1 = 0;

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":182 */
  __pyx_k14 = (-1);

  /* "/home/ivan/Desktop/ncrypt-0.6.4/ncrypt_ssl.pyx":361 */
  return;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("ncrypt_ssl");
}

static char *__pyx_filenames[] = {
  "ncrypt_ssl.pyx",
  "ncrypt_x509.pxd",
  "ncrypt_dh.pxd",
  "ncrypt_rsa.pxd",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed, char *name) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if ((none_allowed && obj == Py_None) || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError,
        "Argument '%s' has incorrect type (expected %s, got %s)",
        name, type->tp_name, obj->ob_type->tp_name);
    return 0;
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
    PyObject *__import__ = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    __import__ = PyObject_GetAttrString(__pyx_b, "__import__");
    if (!__import__)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    module = PyObject_CallFunction(__import__, "OOOO",
        name, global_dict, empty_dict, list);
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(__import__);
    Py_XDECREF(empty_dict);
    return module;
}

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result)
        PyErr_SetObject(PyExc_NameError, name);
    return result;
}

static PyObject *__Pyx_CreateClass(
    PyObject *bases, PyObject *dict, PyObject *name, char *modname)
{
    PyObject *py_modname;
    PyObject *result = 0;
    
    py_modname = PyString_FromString(modname);
    if (!py_modname)
        goto bad;
    if (PyDict_SetItemString(dict, "__module__", py_modname) < 0)
        goto bad;
    result = PyClass_New(bases, dict, name);
bad:
    Py_XDECREF(py_modname);
    return result;
}

static int __Pyx_GetStarArgs(
    PyObject **args, 
    PyObject **kwds,
    char *kwd_list[], 
    int nargs,
    PyObject **args2, 
    PyObject **kwds2)
{
    PyObject *x = 0, *args1 = 0, *kwds1 = 0;
    
    if (args2)
        *args2 = 0;
    if (kwds2)
        *kwds2 = 0;
    
    if (args2) {
        args1 = PyTuple_GetSlice(*args, 0, nargs);
        if (!args1)
            goto bad;
        *args2 = PyTuple_GetSlice(*args, nargs, PyTuple_Size(*args));
        if (!*args2)
            goto bad;
    }
    else {
        args1 = *args;
        Py_INCREF(args1);
    }
    
    if (kwds2) {
        if (*kwds) {
            char **p;
            kwds1 = PyDict_New();
            if (!kwds)
                goto bad;
            *kwds2 = PyDict_Copy(*kwds);
            if (!*kwds2)
                goto bad;
            for (p = kwd_list; *p; p++) {
                x = PyDict_GetItemString(*kwds, *p);
                if (x) {
                    if (PyDict_SetItemString(kwds1, *p, x) < 0)
                        goto bad;
                    if (PyDict_DelItemString(*kwds2, *p) < 0)
                        goto bad;
                }
            }
        }
        else {
            *kwds2 = PyDict_New();
            if (!*kwds2)
                goto bad;
        }
    }
    else {
        kwds1 = *kwds;
        Py_XINCREF(kwds1);
    }
    
    *args = args1;
    *kwds = kwds1;
    return 0;
bad:
    Py_XDECREF(args1);
    Py_XDECREF(kwds1);
    if (*args2) {
        Py_XDECREF(*args2);
    }
    if (*kwds2) {
        Py_XDECREF(*kwds2);
    }
    return -1;
}

static void __Pyx_WriteUnraisable(char *name) {
    PyObject *old_exc, *old_val, *old_tb;
    PyObject *ctx;
    PyErr_Fetch(&old_exc, &old_val, &old_tb);
    ctx = PyString_FromString(name);
    PyErr_Restore(old_exc, old_val, old_tb);
    if (!ctx)
        ctx = Py_None;
    PyErr_WriteUnraisable(ctx);
}

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    /* Next, repeatedly, replace a tuple exception with its first item */
    while (PyTuple_Check(type) && PyTuple_Size(type) > 0) {
        PyObject *tmp = type;
        type = PyTuple_GET_ITEM(type, 0);
        Py_INCREF(type);
        Py_DECREF(tmp);
    }
    if (PyString_Check(type)) {
        if (PyErr_Warn(PyExc_DeprecationWarning,
                "raising a string exception is deprecated"))
            goto raise_error;
    }
    else if (PyType_Check(type) || PyClass_Check(type))
        ; /*PyErr_NormalizeException(&type, &value, &tb);*/
    else {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        if (PyInstance_Check(type))
            type = (PyObject*) ((PyInstanceObject*)type)->in_class;
        else
            type = (PyObject*) type->ob_type;
        Py_INCREF(type);
    }
    PyErr_Restore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (obj == Py_None || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %s to %s",
        obj->ob_type->tp_name, type->tp_name);
    return 0;
}

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t) {
    while (t->p) {
        *t->p = PyString_InternFromString(t->s);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
    PyObject *pycobj = 0;
    int result;
    
    pycobj = PyCObject_FromVoidPtr(vtable, 0);
    if (!pycobj)
        goto bad;
    if (PyDict_SetItemString(dict, "__pyx_vtable__", pycobj) < 0)
        goto bad;
    result = 0;
    goto done;

bad:
    result = -1;
done:
    Py_XDECREF(pycobj);
    return result;
}

static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, 
    long size) 
{
    PyObject *py_module_name = 0;
    PyObject *py_class_name = 0;
    PyObject *py_name_list = 0;
    PyObject *py_module = 0;
    PyObject *result = 0;
    
    py_module_name = PyString_FromString(module_name);
    if (!py_module_name)
        goto bad;
    py_class_name = PyString_FromString(class_name);
    if (!py_class_name)
        goto bad;
    py_name_list = PyList_New(1);
    if (!py_name_list)
        goto bad;
    Py_INCREF(py_class_name);
    if (PyList_SetItem(py_name_list, 0, py_class_name) < 0)
        goto bad;
    py_module = __Pyx_Import(py_module_name, py_name_list);
    if (!py_module)
        goto bad;
    result = PyObject_GetAttr(py_module, py_class_name);
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError, 
            "%s.%s is not a type object",
            module_name, class_name);
        goto bad;
    }
    if (((PyTypeObject *)result)->tp_basicsize != size) {
        PyErr_Format(PyExc_ValueError, 
            "%s.%s does not appear to be the correct type object",
            module_name, class_name);
        goto bad;
    }
    goto done;
bad:
    Py_XDECREF(result);
    result = 0;
done:
    Py_XDECREF(py_module_name);
    Py_XDECREF(py_class_name);
    Py_XDECREF(py_name_list);
    return (PyTypeObject *)result;
}

static int __Pyx_GetVtable(PyObject *dict, void *vtabptr) {
    int result;
    PyObject *pycobj;
    
    pycobj = PyMapping_GetItemString(dict, "__pyx_vtable__");
    if (!pycobj)
        goto bad;
    *(void **)vtabptr = PyCObject_AsVoidPtr(pycobj);
    if (!*(void **)vtabptr)
        goto bad;
    result = 0;
    goto done;

bad:
    result = -1;
done:
    Py_XDECREF(pycobj);
    return result;
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_tuple = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    
    py_srcfile = PyString_FromString(__pyx_filename);
    if (!py_srcfile) goto bad;
    py_funcname = PyString_FromString(funcname);
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    empty_tuple = PyTuple_New(0);
    if (!empty_tuple) goto bad;
    empty_string = PyString_FromString("");
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        empty_tuple,  /*PyObject *consts,*/
        empty_tuple,  /*PyObject *names,*/
        empty_tuple,  /*PyObject *varnames,*/
        empty_tuple,  /*PyObject *freevars,*/
        empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_Get(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_tuple);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}
